{"PRISMS-Math-Team-Training/20250915-PRISMS-Senior-Varsity-Training":{"slug":"PRISMS-Math-Team-Training/20250915-PRISMS-Senior-Varsity-Training","filePath":"PRISMS Math Team Training/20250915 PRISMS Senior Varsity Training.md","title":"20250915 PRISMS Senior Varsity Training","links":[],"tags":[],"content":"Problem 1\n(2013 PUMaC, Number Theory Problem 2) Find the smallest n such that 2013^n ends in 001.\nSolution 1\nIt is easy to prove that the problem is equivalent to finding the smallest n&gt;0 such that 2013^n\\equiv1\\pmod{1000}.\n\\begin{align}\n2013^n\\equiv1\\pmod{1000}&amp;\\Longleftrightarrow2013^n\\equiv1\\pmod{2^3}\\land2013^n\\equiv1\\pmod{5^3}\\\\\n&amp;\\Longleftrightarrow5^n\\equiv1\\pmod{2^3}\\land13^n\\equiv1\\pmod{5^3}\\\\\n&amp;\\Longleftrightarrow2^3\\mid5^n-1^n\\land5^3\\mid13^n-1^n\\\\\n&amp;\\Longleftrightarrow\\nu_2(5^n-1^n)\\ge3\\land\\nu_5(13^n-1^n)\\ge3\\\\\n\\end{align}\nIf n\\equiv0\\pmod2, applying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_2(5^n-1^n)&amp;=\\nu_2(4)+\\nu_2(6)+\\nu_2(n)-1\\\\\n&amp;=2+1+\\nu_2(n)-1\\\\\n&amp;\\ge3\n\\end{align}\nIf n\\equiv1\\pmod2, applying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_2(5^n-1^n)&amp;=\\nu_2(4)\\\\\n&amp;=2\\\\\n&amp;&lt;3\n\\end{align}\nTherefore,\n\\nu_2(5^n-1^n)\\ge3\\Longleftrightarrow2\\mid n\n\\begin{align}\n\\nu_5(13^n-1^n)\\ge3&amp;\\Longrightarrow3^n\\equiv1\\pmod5\\\\\n&amp;\\Longleftrightarrow\\delta_5(3)\\mid n\\\\\n&amp;\\Longleftrightarrow4\\mid n\n\\end{align}\nTherefore,\n\\begin{align}\n\\nu_5(13^n-1^n)\\ge3&amp;\\Longleftrightarrow4\\mid n\\land\\nu_5(13^n-1^n)\\ge3\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land\\nu_5(13^n-1^n)\\ge3\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land\\nu_5((13^4)^k-(1^4)^k)\\ge3\\\\\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_5((13^4)^k-(1^4)^k)&amp;=\\nu_5(13^4-1^4)+\\nu_5(k)\\\\\n&amp;=\\nu_5(13-1)+\\nu_5(13+1)+\\nu_5(13^2+1^2)+\\nu_5(k)\\\\\n&amp;=1+\\nu_5(k)\n\\end{align}\nTherefore,\n\\begin{align}\n\\nu_5(13^n-1^n)\\ge3&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land1+\\nu_5(k)\\ge3\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land25\\mid k\\\\\n&amp;\\Longleftrightarrow100\\mid n\n\\end{align}\nTherefore,\n\\begin{align}\n2013^n\\equiv1\\pmod{1000}&amp;\\Longleftrightarrow2\\mid n\\land100\\mid n\\\\\n&amp;\\Longleftrightarrow100\\mid n\n\\end{align}\nThe smallest n&gt;0 such that 100\\mid n is 100.\nProblem 2\n(2020 AIME I, Problem 12) Let n be the least positive integer such that 149^n-2^n is divisible by 3^35^57^7. Find the number of positive divisors of n.\nSolution 2\n\\begin{align}\n3^35^57^7\\mid(149^n-2^n)&amp;\\Longleftrightarrow3^3\\mid149^n-2^n\\land5^5\\mid149^n-2^n\\land7^7\\mid149^n-2^n\\\\\n&amp;\\Longleftrightarrow\\nu_3(149^n-2^n)\\ge3\\land\\nu_5(149^n-2^n)\\ge5\\land\\nu_7(149^n-2^n)\\ge7\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_3(149^n-2^n)&amp;=\\nu_3(147)+\\nu_3(n)\\\\\n&amp;=1+\\nu_3(n)\n\\end{align}\nTherefore,\n\\begin{align}\n\\nu_3(149^n-2^n)\\ge3&amp;\\Longleftrightarrow1+\\nu_3(n)\\ge3\\\\\n&amp;\\Longleftrightarrow3^2\\mid n\n\\end{align}\n\\nu_5(149^n-2^n)\\ge5\\Longrightarrow149^n\\equiv2^n\\pmod5\nSince\n149^n\\equiv\\begin{cases}\n1\\pmod5, &amp;n\\equiv0\\pmod2\\\\\n4\\pmod5, &amp;n\\equiv1\\pmod2\n\\end{cases}\n2^n\\equiv\\begin{cases}\n1\\pmod5, &amp;n\\equiv0\\pmod4\\\\\n2\\pmod5, &amp;n\\equiv1\\pmod4\\\\\n4\\pmod5, &amp;n\\equiv2\\pmod4\\\\\n3\\pmod5, &amp;n\\equiv3\\pmod4\n\\end{cases}\nit follows that\n149^n\\equiv2^n\\pmod5\\Longleftrightarrow4\\mid n\nTherefore,\n\\begin{align}\n\\nu_5(149^n-2^n)\\ge5&amp;\\Longleftrightarrow4\\mid n\\land\\nu_5(149^n-2^n)\\ge5\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land\\nu_5(149^n-2^n)\\ge5\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land\\nu_5((149^4)^n-(2^4)^n)\\ge5\\\\\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_5((149^4)^k-(2^4)^k)&amp;=\\nu_5(149^4-2^4)+\\nu_5(k)\\\\\n&amp;=\\nu_5(149-2)+\\nu_5(149+2)+\\nu_5(149^2+2^2)+\\nu_5(k)\\\\\n&amp;=1+\\nu_5(k)\n\\end{align}\nTherefore,\n\\begin{align}\n\\nu_5(149^n-2^n)\\ge5&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land1+\\nu_5(k)\\ge5\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,n=4k\\land5^4\\mid k\\\\\n&amp;\\Longleftrightarrow4\\cdot5^4\\mid n\\\\\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_7(149^n-2^n)&amp;=\\nu_7(147)+\\nu_7(n)\\\\\n&amp;=2+\\nu_7(n)\n\\end{align}\nTherefore,\n\\begin{align}\n\\nu_7(149^n-2^n)\\ge7&amp;\\Longleftrightarrow2+\\nu_7(n)\\ge7\\\\\n&amp;\\Longleftrightarrow7^5\\mid n\n\\end{align}\nTherefore,\n\\begin{align}\n3^35^57^7\\mid149^n-2^n&amp;\\Longleftrightarrow3^2\\mid n\\land4\\cdot5^4\\mid n\\land 7^5\\mid n\\\\\n&amp;\\Longleftrightarrow2^23^25^47^5\\mid n\n\\end{align}\nThe smallest n&gt;0 such that 2^23^25^47^5\\mid n is 2^23^25^47^5, it has (2+1)(2+1)(4+1)(5+1)=270 divisors.\nProblem 3\n(1991 IMOSL) Find the largest k such that\n1991^k\\mid1990^{1991^{1992}}+1992^{1991^{1990}}\nSolution 3\n\\begin{align}\n1991^k\\mid1990^{1991^{1992}}+1992^{1991^{1990}}&amp;\\Longleftrightarrow11^k\\mid1990^{1991^{1992}}+1992^{1991^{1990}}\\land181^k\\mid1990^{1991^{1992}}+1992^{1991^{1990}}\\\\\n&amp;\\Longleftrightarrow\\nu_{11}(1990^{1991^{1992}}+1992^{1991^{1990}})\\ge k\\land\\nu_{181}(1990^{1991^{1992}}+1992^{1991^{1990}})\\ge k\\\\\n\\end{align}\n\\begin{align}\n1990^{1991^{1992}}+1992^{1991^{1990}}&amp;=1990^{1991^{1990}1991^2}+1992^{1991^{1990}}\\\\\n&amp;=(1990^{1991^2})^{1991^{1990}}+1992^{1991^{1990}}\n\\end{align}\nTherefore,\n\\nu_{11}(1990^{1991^{1992}}+1992^{1991^{1990}})=\\nu_{11}((1990^{1991^2})^{1991^{1990}}+1992^{1991^{1990}})\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_{11}((1990^{1991^2})^{1991^{1990}}+1992^{1991^{1990}})&amp;=\\nu_{11}(1990^{1991^2}+1992)+1990\\nu_{11}(1991)\\\\\n&amp;=\\nu_{11}(\\sum_{n=0}^{1991^2}\\binom{1991^2}{n}1991^n(-1)^{1991^2-n}+1992)+1990\\\\\n&amp;=\\nu_{11}(\\sum_{n=1}^{1991^2}\\binom{1991^2}{n}1991^n(-1)^{1991^2-n}+1991)+1990\\\\\n&amp;=\\nu_{11}(1991)+\\nu_{11}(\\sum_{n=1}^{1991^2}\\binom{1991^2}{n}1991^{n-1}(-1)^{1991^2-n}+1)+1990\\\\\n&amp;=1+0+1990\\\\\n&amp;=1991\\\\\n\\end{align}\nSimilarly, it follows that\n\\nu_{181}(1990^{1991^{1992}}+1992^{1991^{1990}})=1991\nTherefore,\n\\begin{align}\n1991^k\\mid1990^{1991^{1992}}+1992^{1991^{1990}}&amp;\\Longleftrightarrow1991\\ge k\\land1991\\ge k\\\\\n&amp;\\Longleftrightarrow1991\\ge k\n\\end{align}\nThe largest k such that 1991\\ge k is 1991.\nProblem 4\n(2006 KMO first round, Problem 6) If m is an integer such that\n3^m\\mid7^{3^{527}}-1\nfind the maximum possible value of m.\nSolution 4\n3^m\\mid7^{3^{527}}-1\\Longleftrightarrow\\nu_3(7^{3^{527}}-1^{3^{527}})\\ge m\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_3(7^{3^{527}}-1^{3^{527}})&amp;=\\nu_3(6)+\\nu_3(3^{527})\\\\\n&amp;=1+527\\\\\n&amp;=528\\\\\n\\end{align}\nTherefore,\n3^m\\mid7^{3^{527}}-1\\Longleftrightarrow528\\ge m\nThe largest integer m such that 528\\ge m is 528.\nProblem 5\nFind the sum of all the divisors d of N=19^{88}-1 which are of the form d=2^a3^b with a,b\\in\\N.\nSolution 5\n\\begin{align}\n2^a3^b\\mid19^{88}-1&amp;\\Longleftrightarrow2^a\\mid19^{88}-1\\land3^b\\mid19^{88}-1\\\\\n&amp;\\Longleftrightarrow\\nu_2(19^{88}-1^{88})\\ge a\\land\\nu_3(19^{88}-1^{88})\\ge b\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_2(19^{88}-1^{88})&amp;=\\nu_2(19-1)+\\nu_2(19+1)+\\nu_2(88)-1\\\\\n&amp;=1+2+3-1\\\\\n&amp;=5\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_3(19^{88}-1^{88})&amp;=\\nu_3(19-1)+\\nu_3(88)\\\\\n&amp;=2\\\\\n\\end{align}\nTherefore,\n2^a3^b\\mid19^{88}-1\\Longleftrightarrow5\\ge a\\land2\\ge b\nThe sum of all the divisors d of the form d=2^a3^b is\n\\begin{align}\n\\sum_{a=0}^5\\sum_{b=0}^22^a3^b&amp;=(\\sum_{a=0}^52^a)(\\sum_{b=0}^23^b)\\\\\n&amp;=63\\cdot13\\\\\n&amp;=819\n\\end{align}\nProblem 6\nLet k be a positive integer. Find all positive integers n such that 3^k\\mid2^n-1.\nSolution 6\n\\begin{align}\n3^k\\mid2^n-1&amp;\\Longrightarrow3\\mid2^n-1\\\\\n&amp;\\Longleftrightarrow2^n\\equiv1\\pmod3\\\\\n&amp;\\Longleftrightarrow\\delta_3(2)\\mid n\\\\\n&amp;\\Longleftrightarrow2\\mid n\\\\\n\\end{align}\nTherefore,\n\\begin{align}\n3^k\\mid2^n-1&amp;\\Longleftrightarrow2\\mid n\\land3^k\\mid2^n-1\\\\\n&amp;\\Longleftrightarrow\\exist m\\in\\Z,n=2m\\land3^k\\mid2^n-1\\\\\n&amp;\\Longleftrightarrow\\exist m\\in\\Z,n=2m\\land3^k\\mid4^m-1\\\\\n&amp;\\Longleftrightarrow\\exist m\\in\\Z,n=2m\\land\\nu_3(4^m-1^m)\\ge k\\\\\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_3(4^m-1^m)&amp;=\\nu_3(4-1)+\\nu_3(m)\\\\\n&amp;=1+\\nu_3(m)\\\\\n\\end{align}\nTherefore,\n\\begin{align}\n3^k\\mid(2^n-1)&amp;\\Longleftrightarrow\\exist m\\in\\Z,n=2m\\land1+\\nu_3(m)\\ge k\\\\\n&amp;\\Longleftrightarrow\\exist m\\in\\Z,n=2m\\land3^{k-1}\\mid m\\\\\n&amp;\\Longleftrightarrow2\\cdot3^{k-1}\\mid m\n\\end{align}\nProblem 7\nFind all primes p,q such that\n\\frac{(5^p-2^p)(5^q-2^q)}{pq}\nis an integer.\nSolution 7\nWlog, assume p\\le q.\n\\frac{(5^p-2^p)(5^q-2^q)}{pq}\\in\\Z\\Longleftrightarrow pq\\mid(5^p-2^p)(5^q-2^q)\nSince\n(5^p-2^p)(5^q-2^q)\\equiv1\\pmod2\nit follows that\npq\\mid(5^p-2^p)(5^q-2^q)\\Longrightarrow p\\ne2\\land q\\ne2\n\\begin{align}\npq\\mid(5^p-2^p)(5^q-2^q)&amp;\\Longrightarrow p\\mid(5^p-2^p)(5^q-2^q)\\\\\n&amp;\\Longleftrightarrow(5^p-2^p)(5^q-2^q)\\equiv0\\pmod p\n\\end{align}\nApplying Fermat’s Little Theorem yields\n5^p-2^p\\equiv3\\pmod p\nTherefore, if p\\ne 3,\n\\begin{align}\n(5^p-2^p)(5^q-2^q)\\equiv0\\pmod p&amp;\\Longleftrightarrow5^q-2^q\\equiv0\\pmod p\\\\\n&amp;\\Longleftrightarrow\\left(\\frac{5}{2}\\right)^q\\equiv1\\pmod p\\\\\n&amp;\\Longleftrightarrow\\delta_p\\left(\\frac{5}{2}\\right)\\mid q\\\\\n&amp;\\Longleftrightarrow\\delta_p\\left(\\frac{5}{2}\\right)=q\\\\\n\\end{align}\nApplying Fermat’s Little Theorem yields\n\\left(\\frac{5}{2}\\right)^{p-1}\\equiv1\\pmod p\n\\left(\\frac{5}{2}\\right)^{p-1}\\equiv1\\pmod p\\Longleftrightarrow\\delta_p\\left(\\frac{5}{2}\\right)\\mid p-1\nTherefore,\n\\begin{align}\n(5^p-2^p)(5^q-2^q)\\equiv0\\pmod p&amp;\\Longrightarrow q\\mid p-1\\\\\n&amp;\\Longrightarrow q&lt;p\n\\end{align}\nBy contradiction, p=3.\nTherefore,\n\\begin{align}\npq\\mid(5^p-2^p)(5^q-2^q)&amp;\\Longleftrightarrow39(5^q-2^q)\\equiv0\\pmod q\\\\\n&amp;\\Longleftrightarrow q\\mid117\\\\\n&amp;\\Longleftrightarrow q=3\\lor q=13\\\\\n\\end{align}\nTherefore, all primes p,q such that\n\\frac{(5^p-2^p)(5^q-2^q)}{pq}\nis an integer are \\langle p,q\\rangle=\\langle3,3\\rangle, \\langle p,q\\rangle=\\langle3,13\\rangle and \\langle p,q\\rangle=\\langle13,3\\rangle.\nProblem 8\nFind all positive integers n such that 3^n-1 is divisible by 2^n.\nSolution 8\n2^n\\mid3^n-1\\Longleftrightarrow\\nu_2(3^n-1^n)\\ge n\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_2(3^n-1^n)&amp;=\\begin{cases}\n\\nu_2(3-1)+\\nu_2(3+1)+\\nu_2(n)-1,&amp;n\\equiv0\\pmod2\\\\\n\\nu_2(3-1),&amp;n\\equiv1\\pmod2\\\\\n\\end{cases}\\\\\n&amp;=\\begin{cases}\n\\nu_2(n)+2,&amp;n\\equiv0\\pmod2\\\\\n1,&amp;n\\equiv1\\pmod2\\\\\n\\end{cases}\n\\end{align}\nTherefore,\n\\begin{align}\n\\nu_2(3^n-1^n)\\ge n&amp;\\Longleftrightarrow(n\\equiv0\\pmod2\\land\\nu_2(n)+2\\ge n)\\lor(n\\equiv1\\pmod2\\land1\\ge n)\\\\\n&amp;\\Longleftrightarrow(n\\equiv0\\pmod2\\land 2^{n-2}\\mid n)\\lor n=1\\\\\n&amp;\\Longleftrightarrow n=1\\lor n=2\\lor n=4\n\\end{align}\nTherefore,\n2^n\\mid3^n-1\\Longleftrightarrow n=1\\lor n=2\\lor n=4\nProblem 9\nFind all positive integers a such that \\frac{5^a+1}{3^a} is a positive integer.\nSolution 9\n\\begin{align}\n\\frac{5^a+1}{3^a}\\in\\Z_+&amp;\\Longleftrightarrow3^a\\mid5^a+1\\\\\n&amp;\\Longrightarrow5^a+1\\equiv0\\pmod3\\\\\n&amp;\\Longleftrightarrow2^a\\equiv2\\pmod3\\\\\n&amp;\\Longleftrightarrow a\\equiv1\\pmod2\n\\end{align}\nTherefore,\n\\begin{align}\n3^a\\mid5^a+1&amp;\\Longleftrightarrow a\\equiv1\\pmod2\\land 3^a\\mid5^a+1\\\\\n&amp;\\Longleftrightarrow a\\equiv1\\pmod2\\land\\nu_3(5^a+1^a)\\ge a\\\\\n\\end{align}\nApplying the Lifting the Exponent Lemma yields that, if a\\equiv1\\pmod 2,\n\\begin{align}\n\\nu_3(5^a+1^a)&amp;=\\nu_3(6)+\\nu_3(a)\\\\\n&amp;=1+\\nu_3(a)\n\\end{align}\nTherefore,\n\\begin{align}\n3^a\\mid5^a+1&amp;\\Longleftrightarrow1+\\nu_3(a)\\ge a\\\\\n&amp;\\Longleftrightarrow3^{a-1}\\mid a\\\\\n&amp;\\Longleftrightarrow a=1\n\\end{align}\nTherefore, the only positive integer a such that \\frac{5^a+1}{3^a} is a positive integer is a=1.\nProblem 10\n(PUMaC 2023 Division A, Individual Finals Problem 1) Let p&gt;3 be a prime and k\\ge0 an integer. Find the multiplicity of X-1 in the factorization of\nf(X)=X^{3p^k-1}+X^{3p^k-2}+\\dots+X+1\nmodulo p.\nSolution 10\n\\begin{align}\nf(X)&amp;\\equiv X^{3p^k-1}+X^{3p^k-2}+\\dots+X+1\\pmod p\\\\\n&amp;\\equiv\\frac{X^{3p^k}-1}{X-1}\\pmod p\\\\\n&amp;\\equiv\\frac{(X^3)^{p^k}-1^{p^k}}{X-1}\\pmod p\\\\\n&amp;\\equiv\\frac{(X^3-1)^{p^k}}{X-1}\\pmod p\\\\\n&amp;\\equiv(X-1)^{p^k-1}(X^2+X+1)^{p^k}\\pmod p\\\\\n\\end{align}\nSince when X=1, X-1\\equiv0\\pmod p, X^2+X+1\\not\\equiv0\\pmod p, it follows that the multiplicity of X-1 in the factorization of f(X) is p^k-1, modulo p.\nProblem 11\n(2017 CGMO, Problem 1) Find all positive integers n such that for every positive odd integer a, we have\n2^{2017}\\mid a^n-1\nSolution 11\n\\forall a,2^{2017}\\mid a^n-1\\Longleftrightarrow\\forall a,\\nu_2(a^n-1^n)\\ge2017\nApplying the Lifting the Exponent Lemma yields\n\\nu_2(a^n-1^n)=\\begin{cases}\n\\nu_2(a-1)+\\nu_2(a+1)+\\nu_2(n)-1,&amp;n\\equiv0\\pmod2\\\\\n\\nu_2(a-1),&amp;n\\equiv1\\pmod2\n\\end{cases}\nTherefore,\n\\begin{align}\n\\forall a,2^{2017}\\mid a^n-1&amp;\\Longleftrightarrow(n\\equiv0\\pmod2\\land\\forall a,\\nu_2(a-1)+\\nu_2(a+1)+\\nu_2(n)-1\\ge2017)\\lor(n\\equiv1\\pmod2\\land\\forall a,\\nu_2(a-1)\\ge2017)\\\\\n&amp;\\Longleftrightarrow n\\equiv0\\pmod2\\land\\forall a,\\nu_2(n)\\ge2018-\\nu_2(a-1)-\\nu_2(a+1)\\\\\n&amp;\\Longleftrightarrow n\\equiv0\\pmod2\\land\\nu_2(n)\\ge2018-\\min_a\\{\\nu_2(a-1)+\\nu_2(a+1)\\}\\\\\n&amp;\\Longleftrightarrow n\\equiv0\\pmod2\\land\\nu_2(n)\\ge2015\\\\\n&amp;\\Longleftrightarrow2^{2015}\\mid n\n\\end{align}\nProblem 12\n(2010 China Western Mathematical Olympiad, Problem 1) Let m,k\\ge0,p=2^{2^m}+1 a prime. Prove:\n\n2^{2^{m+1}p^k}\\equiv1\\pmod{p^{k+1}};\nThe smallest n such that 2^n\\equiv1\\pmod{p^{k+1}} is 2^{m+1}p^k.\n\nSolution 12\n\\begin{align}\n2^{2^{m+1}p^k}\\equiv1\\pmod{p^{k+1}}&amp;\\Longleftrightarrow p^{k+1}\\mid2^{2^{m+1}p^k}-1\\\\\n&amp;\\Longleftrightarrow\\nu_p((2^{2^{m+1}})^{p^k}-1^{p^k})\\ge k+1\n\\end{align}\nApplying the Lifting the Exponent Lemma yields\n\\begin{align}\n\\nu_p((2^{2^{m+1}})^{p^k}-1^{p^k})&amp;=\\nu_p(2^{2^{m+1}}-1)+k\\nu_p(p)\\\\\n&amp;=\\nu_p(2^{2^m}-1)+\\nu_p(2^{2^m}+1)+k\\\\\n&amp;=k+1\\\\\n\\end{align}\nTherefore,\n2^{2^{m+1}p^k}\\equiv1\\pmod{p^{k+1}}\nIf \\delta_{p^{k+1}}(2)&lt;2^{m+1}p^k,\n\\begin{align}\n2^{2^{m+1}p^k}\\equiv1\\pmod{p^{k+1}}&amp;\\Longleftrightarrow\\delta_{p^{k+1}}(2)\\mid2^{m+1}p^k\\\\\n&amp;\\Longleftrightarrow\\delta_{p^{k+1}}(2)\\mid2^mp^k\\lor(k&gt;0\\land\\delta_{p^{k+1}}(2)\\mid2^{m+1}p^{k-1})\\\\\n&amp;\\Longleftrightarrow2^{2^mp^k}\\equiv1\\pmod{p^{k+1}}\\lor(k&gt;0\\land2^{2^{m+1}p^{k-1}}\\equiv1\\pmod{p^{k+1}})\\\\\n\\end{align}\n\\begin{align}\np=2^{2^m}+1&amp;\\Longleftrightarrow2^{2^m}\\equiv-1\\pmod p\\\\\n&amp;\\Longrightarrow2^{2^mp^k}\\equiv-1\\pmod p\\\\\n&amp;\\Longleftrightarrow p\\mid2^{2^mp^k}+1\\\\\n&amp;\\Longrightarrow p\\nmid2^{2^mp^k}-1\\\\\n&amp;\\Longrightarrow p^{k+1}\\nmid2^{2^mp^k}-1\\\\\n&amp;\\Longleftrightarrow2^{2^mp^k}\\not\\equiv1\\pmod{p^{k+1}}\n\\end{align}\nFor k&gt;0,\n\\begin{align}\n2^{2^{m+1}p^{k-1}}\\equiv1\\pmod{p^{k+1}}&amp;\\Longleftrightarrow p^{k+1}\\mid2^{2^{m+1}p^{k-1}}-1\\\\\n&amp;\\Longleftrightarrow\\nu_p((2^{2^{m+1}})^{p^{k-1}}-1^{p^{k-1}})\\ge k+1\\\\\n&amp;\\Longleftrightarrow k\\ge k+1\\\\\n\\end{align}\nTherefore,\n2^{2^{m+1}p^{k-1}}\\not\\equiv1\\pmod{p^{k+1}}\nTherefore,\n2^{2^{m+1}p^k}\\not\\equiv1\\pmod{p^{k+1}}\nBy contradiction,\n\\delta_{p^{k+1}}(2)=2^{m+1}p^k\nTherefore, the smallest n such that 2^n\\equiv1\\pmod{p^{k+1}} is 2^{m+1}p^k."},"PRISMS-Math-Team-Training/20250919-PRISMS-Junior-Varsity-Training":{"slug":"PRISMS-Math-Team-Training/20250919-PRISMS-Junior-Varsity-Training","filePath":"PRISMS Math Team Training/20250919 PRISMS Junior Varsity Training.md","title":"20250919 PRISMS Junior Varsity Training","links":[],"tags":[],"content":"Problem 1\nFind all the roots of equation 2x-2.8=\\lfloor x\\rfloor.\nSolution 1\n\\begin{align}\n2x-2.8=\\lfloor x\\rfloor&amp;\\Longrightarrow x-1&lt;2x-2.8\\le x\\\\\n&amp;\\Longleftrightarrow1.8&lt;x\\le2.8\\\\\n&amp;\\Longrightarrow\\lfloor x\\rfloor=1\\lor\\lfloor x\\rfloor=2\n\\end{align}\nIf \\lfloor x\\rfloor=1,\n\\begin{align}\n2x-2.8=\\lfloor x\\rfloor&amp;\\Longleftrightarrow2x-2.8=1\\\\\n&amp;\\Longleftrightarrow x=1.9\n\\end{align}\nIf \\lfloor x\\rfloor=2,\n\\begin{align}\n2x-2.8=\\lfloor x\\rfloor&amp;\\Longleftrightarrow2x-2.8=2\\\\\n&amp;\\Longleftrightarrow x=2.4\n\\end{align}\nTherefore,\n2x-2.8=\\lfloor x\\rfloor\\Longleftrightarrow x=1.9\\lor x=2.4\nThe roots of equation 2x-2.8=\\lfloor x\\rfloor are x=1.9 and x=2.4.\nProblem 2\nSolve equation x^2-\\lfloor x\\rfloor-2=0.\nSolution 2\n\\begin{align}\nx^2-\\lfloor x\\rfloor-2=0&amp;\\Longleftrightarrow x^2-2=\\lfloor x\\rfloor\\\\\n&amp;\\Longrightarrow x-1&lt;x^2-2\\le x\\\\\n&amp;\\Longleftrightarrow x-1&lt;x^2-2\\land x^2-2\\le x\\\\\n&amp;\\Longleftrightarrow(x&lt;\\frac{1-\\sqrt5}{2}\\lor x&gt;\\frac{1+\\sqrt5}{2})\\land(-1\\le x\\le2)\\\\\n&amp;\\Longleftrightarrow-1\\le x&lt;\\frac{1-\\sqrt5}{2}\\lor\\frac{1+\\sqrt5}{2}&lt;x\\le2\\\\\n&amp;\\Longrightarrow\\lfloor x\\rfloor=-1\\lor\\lfloor x\\rfloor=1\\lor\\lfloor x\\rfloor=2\n\\end{align}\nIf \\lfloor x\\rfloor=-1,\n\\begin{align}\nx^2-2=\\lfloor x\\rfloor&amp;\\Longleftrightarrow x^2-2=-1\\\\\n&amp;\\Longleftrightarrow x=-1\n\\end{align}\nIf \\lfloor x\\rfloor=1,\n\\begin{align}\nx^2-2=\\lfloor x\\rfloor&amp;\\Longleftrightarrow x^2-2=1\\\\\n&amp;\\Longleftrightarrow x=\\sqrt3\n\\end{align}\nIf \\lfloor x\\rfloor=2,\n\\begin{align}\nx^2-2=\\lfloor x\\rfloor&amp;\\Longleftrightarrow x^2-2=2\\\\\n&amp;\\Longleftrightarrow x=2\n\\end{align}\nTherefore,\nx^2-\\lfloor x\\rfloor-2=0\\Longleftrightarrow x=-1\\lor x=\\sqrt3\\lor x=2\nThe roots of equation x^2-\\lfloor x\\rfloor-2=0 are x=-1, x=\\sqrt3 and x=2.\nProblem 3\nSolve equation \\lfloor\\frac{5x-13}{3}\\rfloor=\\frac{3x+1}{5}.\nSolution 3\n\\begin{align}\n\\left\\lfloor\\frac{5x-13}{3}\\right\\rfloor=\\frac{3x+1}{5}&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\left\\lfloor\\frac{5x-13}{3}\\right\\rfloor=k\\land\\frac{3x+1}{5}=k\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\left\\lfloor\\frac{5x-13}{3}\\right\\rfloor=k\\land x=\\frac{5k-1}{3}\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\left\\lfloor\\frac{25k-44}{9}\\right\\rfloor=k\\land x=\\frac{5k-1}{3}\\\\\n\\end{align}\n\\begin{align}\n\\left\\lfloor\\frac{25k-44}{9}\\right\\rfloor=k&amp;\\Longleftrightarrow k\\le\\frac{25k-44}{9}&lt;k+1\\\\\n&amp;\\Longleftrightarrow\\frac{11}{4}\\le k&lt;\\frac{53}{16}\\\\\n&amp;\\Longleftrightarrow k=3\n\\end{align}\nTherefore,\n\\begin{align}\n\\left\\lfloor\\frac{5x-13}{3}\\right\\rfloor=\\frac{3x+1}{5}&amp;\\Longleftrightarrow\\exist k\\in\\Z,k=3\\land x=\\frac{5k-1}{3}\\\\\n&amp;\\Longleftrightarrow x=\\frac{14}{3}\n\\end{align}\nThe root of equation \\lfloor\\frac{5x-13}{3}\\rfloor=\\frac{3x+1}{5} is x=\\frac{14}{3}.\nProblem 4\n3x-3=\\lfloor x\\rfloor\nSolution 4\n\\begin{align}\n3x-3=\\lfloor x\\rfloor&amp;\\Longrightarrow x-1&lt;3x-3\\le x\\\\\n&amp;\\Longleftrightarrow1&lt;x\\le\\frac{3}{2}\\\\\n&amp;\\Longrightarrow\\lfloor x\\rfloor=1\\\\\n\\end{align}\nIf \\lfloor x\\rfloor=1,\n\\begin{align}\n3x-3=\\lfloor x\\rfloor&amp;\\Longleftrightarrow3x-3=1\\\\\n&amp;\\Longleftrightarrow x=\\frac{4}{3}\n\\end{align}\nTherefore,\n3x-3=\\lfloor x\\rfloor\\Longleftrightarrow x=\\frac{4}{3}\nProblem 5\n5-x^2=\\lfloor x\\rfloor\nSolution 5\n\\begin{align}\n5-x^2=\\lfloor x\\rfloor&amp;\\Longrightarrow x-1&lt;5-x^2\\le x\\\\\n&amp;\\Longleftrightarrow x-1&lt;5-x^2\\land5-x^2\\le x\\\\\n&amp;\\Longleftrightarrow-3&lt;x&lt;2\\land(x\\le\\frac{-1-\\sqrt{21}}{2}\\lor x\\ge\\frac{-1+\\sqrt{21}}{2})\\\\\n&amp;\\Longleftrightarrow-3&lt;x\\le\\frac{-1-\\sqrt{21}}{2}\\lor\\frac{-1+\\sqrt{21}}{2}\\le x&lt;2\\\\\n&amp;\\Longrightarrow\\lfloor x\\rfloor=-3\\lor\\lfloor x\\rfloor=1\n\\end{align}\nIf \\lfloor x\\rfloor=-3,\n5-x^2=-3\\Longleftrightarrow x=-2\\sqrt2\nIf \\lfloor x\\rfloor=1,\n5-x^2=1\nTherefore,\n5-x^2=\\lfloor x\\rfloor\\Longleftrightarrow x=-2\\sqrt2\nProblem 6\n|x-2|=\\lfloor x\\rfloor\nSolution 6\n\\begin{align}\n\\lfloor x\\rfloor\\in\\Z&amp;\\Longleftrightarrow|x-2|\\in\\Z\\\\\n&amp;\\Longleftrightarrow x\\in\\Z\\\\\n&amp;\\Longleftrightarrow\\lfloor x\\rfloor=x\\\\\n\\end{align}\nTherefore,\n\\begin{align}\n|x-2|=\\lfloor x\\rfloor&amp;\\Longleftrightarrow|x-2|=x\\\\\n&amp;\\Longleftrightarrow x=1\n\\end{align}\nProblem 7\n\\frac{3x+2}{4}=\\left\\lfloor\\frac{6x-1}{5}\\right\\rfloor\nSolution 7\n\\begin{align}\n\\frac{3x+2}{4}=\\left\\lfloor\\frac{6x-1}{5}\\right\\rfloor&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\frac{3x+2}{4}=k\\land\\left\\lfloor\\frac{6x-1}{5}\\right\\rfloor=k\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,x=\\frac{4k-2}{3}\\land\\left\\lfloor\\frac{6x-1}{5}\\right\\rfloor=k\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,x=\\frac{4k-2}{3}\\land\\left\\lfloor\\frac{8k}{5}\\right\\rfloor=k+1\n\\end{align}\n\\begin{align}\n\\left\\lfloor\\frac{8k}{5}\\right\\rfloor=k+1&amp;\\Longleftrightarrow k+1\\le\\frac{8k}{5}&lt;k+2\\\\\n&amp;\\Longleftrightarrow k+1\\le\\frac{8k}{5}&lt;k+2\\\\\n&amp;\\Longleftrightarrow\\frac{5}{3}\\le k&lt;\\frac{10}{3}\\\\\n&amp;\\Longleftrightarrow k=2\\lor k=3\n\\end{align}\nTherefore,\n\\begin{align}\n\\frac{3x+2}{4}=\\left\\lfloor\\frac{6x-1}{5}\\right\\rfloor&amp;\\Longleftrightarrow\\exist k\\in\\Z,x=\\frac{4k-2}{3}\\land(k=2\\lor k=3)\\\\\n&amp;\\Longleftrightarrow x=2\\lor x=\\frac{10}{3}\n\\end{align}\nProblem 8\n\\begin{cases}\ny=2\\lfloor x\\rfloor+\\sqrt2\\\\\nx=3\\lfloor y\\rfloor-12.5\n\\end{cases}\nSolution 8\n\\begin{align}\ny=2\\lfloor x\\rfloor+\\sqrt2\\land x=3\\lfloor y\\rfloor-12.5&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\lfloor x\\rfloor=k\\land y=2k+\\sqrt2\\land x=3\\lfloor y\\rfloor-12.5\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\lfloor x\\rfloor=k\\land y=2k+\\sqrt2\\land x=3\\lfloor2k+\\sqrt2\\rfloor-12.5\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\lfloor x\\rfloor=k\\land y=2k+\\sqrt2\\land x=6k-9.5\\\\\n&amp;\\Longleftrightarrow\\exist k\\in\\Z,\\lfloor6k-9.5\\rfloor=k\\land y=2k+\\sqrt2\\land x=6k-9.5\\\\\n\\end{align}\n\\begin{align}\n\\lfloor6k-9.5\\rfloor=k&amp;\\Longleftrightarrow k\\le6k-9.5&lt;k+1\\\\\n&amp;\\Longleftrightarrow1.9\\le k&lt;2.1\\\\\n&amp;\\Longleftrightarrow k=2\\\\\n\\end{align}\nTherefore,\n\\begin{align}\ny=2\\lfloor x\\rfloor+\\sqrt2\\land x=3\\lfloor y\\rfloor-12.5&amp;\\Longleftrightarrow\\exist k\\in\\Z,k=2\\land y=2k+\\sqrt2\\land x=6k-9.5\\\\\n&amp;\\Longleftrightarrow x=2.5\\land y=4+\\sqrt2\n\\end{align}"},"PRISMS-Math-Team-Training/20250922-PRISMS-Senior-Varsity-Training":{"slug":"PRISMS-Math-Team-Training/20250922-PRISMS-Senior-Varsity-Training","filePath":"PRISMS Math Team Training/20250922 PRISMS Senior Varsity Training.md","title":"20250922 PRISMS Senior Varsity Training","links":[],"tags":[],"content":"Problem 1\nFind the number of integer values of k in the closed interval [-500,500] for which the equation\n\\log(kx)=2\\log(x+2)\nhas exactly one real solution.\nSolution 1\n\\begin{align}\n\\log(kx)=2\\log(x+2)&amp;\\Longleftrightarrow x&gt;-2\\land\\log(kx)=\\log((x+2)^2)\\\\\n&amp;\\Longleftrightarrow x&gt;-2\\land kx&gt;0\\land kx=(x+2)^2\\\\\n&amp;\\Longleftrightarrow x&gt;-2\\land kx&gt;0\\land x^2+(4-k)x+4=0\\\\\n\\end{align}\nLet f(x)=x^2+(4-k)x+4=(x-x_1)(x-x_2), where x_1=\\frac{k-4-\\sqrt{k(k-8)}}{2},x_2=\\frac{k-4+\\sqrt{k(k-8)}}{2}, then\n\\begin{align}\n\\log(kx)=2\\log(x+2)&amp;\\Longleftrightarrow x&gt;-2\\land kx&gt;0\\land f(x)=0\\\\\n&amp;\\Longleftrightarrow x&gt;-2\\land kx&gt;0\\land(x=x_1\\lor x=x_2)\\\\\n&amp;\\Longrightarrow k&lt;0\\lor k\\ge8\n\\end{align}\nApplying Vieta’s Formulas yields\nx_1+x_2=k-4\\land x_1x_2=4\nIf k&lt;0,\n\\begin{align}\nx_1+x_2=k-4\\land x_1x_2=4&amp;\\Longrightarrow x_1+x_2&lt;0\\land x_1x_2&gt;0\\\\\n&amp;\\Longleftrightarrow x_1&lt;0\\land x_2&lt;0\\\\\n\\end{align}\nSince f&#039;&#039;(x)=2&gt;0\\land f(-2)=2k&lt;0, it follows that\nx_1&lt;-2\\land x_2&gt;-2\nTherefore,\n\\log(kx)=2\\log(x+2)\\Longleftrightarrow x=x_2\nTherefore, if k&lt;0, \\log(kx)=2\\log(x+2) always has exactly one real solution.\nIf k\\ge8,\n\\begin{align}\nx_1+x_2=k-4\\land x_1x_2=4&amp;\\Longrightarrow x_1+x_2&gt;0\\land x_1x_2&gt;0\\\\\n&amp;\\Longleftrightarrow x_1&gt;0\\land x_2&gt;0\\\\\n\\end{align}\nTherefore,\n\\log(kx)=2\\log(x+2)\\Longleftrightarrow x=x_1\\lor x=x_2\nTherefore, if k\\ge8, \\log(kx)=2\\log(x+2) has exactly one real solution iff\n\\begin{align}\nx_1=x_2&amp;\\Longleftrightarrow k(k-8)=0\\\\\n&amp;\\Longleftrightarrow k=8\n\\end{align}\nTherefore, \\log(kx)=2\\log(x+2) has exactly one real solution iff\nk&lt;0\\lor k=8\nThere are 501 integer values of k in [-500,500] such that k&lt;0\\lor k=8.\nProblem 2\nReal numbers x and y with x,y&gt;1 satisfy \\log_x(y^x)=\\log_y(x^{4y})=10. What is the value of xy?\nSolution 2\n\\begin{align}\n\\log_x(y^x)\\log_y(x^{4y})&amp;=x\\log_x(y)\\cdot4y\\log_y(x)\\\\\n&amp;=4xy\n\\end{align}\nTherefore,\n4xy=100\n4xy=100\\Longleftrightarrow xy=25\nProblem 3\nLet x, y and z be positive real numbers that satisfy the following system of equations:\n\\log_2\\left(\\frac{x}{yz}\\right)=\\frac{1}{2},\\log_2\\left(\\frac{y}{xz}\\right)=\\frac{1}{3},\\log_2\\left(\\frac{z}{xy}\\right)=\\frac{1}{4}\nThen the value of \\left|\\log_2(x^4y^3z^2)\\right| is \\frac{m}{n} where m and n are relatively prime positive integers. Find m+n.\nSolution 3\n\\begin{align}\n\\log_2\\left(\\frac{x}{yz}\\right)=\\frac{1}{2}\\land\\log_2\\left(\\frac{y}{xz}\\right)=\\frac{1}{3}\\land\\log_2\\left(\\frac{z}{xy}\\right)=\\frac{1}{4}&amp;\\Longleftrightarrow\\log_2(x)-\\log_2(y)-\\log_2(z)=\\frac{1}{2}\\land\\log_2(y)-\\log_2(x)-\\log_2(z)=\\frac{1}{3}\\land\\log_2(z)-\\log_2(x)-\\log_2(y)=\\frac{1}{4}\\\\\n&amp;\\Longleftrightarrow\\log_2(x)=-\\frac{7}{24}\\land\\log_2(y)=-\\frac{3}{8}\\land\\log_2(z)=-\\frac{5}{12}\n\\end{align}\nTherefore,\n\\begin{align}\n\\left|\\log_2(x^4y^3z^2)\\right|&amp;=\\left|4\\log_2(x)+3\\log_2(y)+2\\log(z)\\right|\\\\\n&amp;=\\frac{25}{8}\n\\end{align}\nTherefore, m+n=33.\nProblem 4\nLet a&gt;1 and x&gt;1 satisfy\n\\log_a(\\log_a(\\log_a(2))+\\log_a(2)-128)=128\\land\\log_a(\\log_a(x))=256\nFind the reminder when x is divided by 1000.\nSolution 4\n\\begin{align}\n\\log_a(\\log_a(\\log_a(2))+\\log_a(24)-128)=128&amp;\\Longleftrightarrow\\log_a(24\\log_a(2))=128+a^{128}\\\\\n&amp;\\Longleftrightarrow\\log_a(2^{24})=a^{128}a^{a^{128}}\\\\\n&amp;\\Longleftrightarrow2^{24}=\\left(a^{a^{128}}\\right)^{a^{a^{128}}}\\\\\n&amp;\\Longleftrightarrow a^{a^{128}}=2^3\\\\\n&amp;\\Longleftrightarrow a=2^\\frac{3}{64}\\\\\n\\end{align}\nTherefore,\n\\begin{align}\n\\log_a(\\log_a(x))=256&amp;\\Longleftrightarrow x=a^{a^{256}}\\\\\n&amp;\\Longleftrightarrow x=2^{192}\\\\\n&amp;\\Longrightarrow x\\equiv896\\pmod{1000}\n\\end{align}\nProblem 5\nLet x, y and z be real numbers satisfying the system\n\\log_2(xyz-3+\\log_5(x))=5\\\\\n\\log_3(xyz-3+\\log_5(y))=4\\\\\n\\log_4(xyz-3+\\log_5(z))=4\nFind the value of \\left|\\log_5(x)\\right|+\\left|\\log_5(y)\\right|+\\left|\\log_5(z)\\right|.\nSolution 5\n\\begin{align}\n\\log_2(xyz-3+\\log_5(x))=5\\land\\log_3(xyz-3+\\log_5(y))=4\\land\\log_4(xyz-3+\\log_5(z))=4&amp;\\Longleftrightarrow xyz+\\log_5(x)=35\\land xyz+\\log_5(y)=84\\land xyz+\\log_5(z)=259\\\\\n&amp;\\Longrightarrow3xyz+\\log_5(xyz)=378\\\\\n&amp;\\Longleftrightarrow xyz=125\n\\end{align}\nTherefore,\nxyz+\\log_5(x)=35\\Longleftrightarrow\\log_5(x)=-90\nxyz+\\log_5(y)=84\\Longleftrightarrow\\log_5(y)=-41\nxyz+\\log_5(z)=259\\Longleftrightarrow\\log_5(z)=134\nTherefore,\n\\left|\\log_5(x)\\right|+\\left|\\log_5(y)\\right|+\\left|\\log_5(z)\\right|=265\nProblem 6\nQuadratic polynomials P(x) and Q(x) have leading coefficients of 2 and -2, respectively. The graphs of both polynomials pass through the two points (16,54) and (20,53). Find P(0)+Q(0).\nSolution 6\nLet P(x)=2x^2+b_Px+c_P, then\n\\begin{align}\nP(16)=54\\land P(20)=53&amp;\\Longleftrightarrow512+16b_P+c_P=54\\land800+20b_P+c_P=53\\\\\n&amp;\\Longleftrightarrow b_P=-\\frac{289}{4}\\land c_P=698\n\\end{align}\nTherefore,\nP(x)=2x^2-\\frac{289}{4}x+698\nLet Q(x)=-2x^2+b_Qx+c_Q, then\n\\begin{align}\nQ(16)=54\\land Q(20)=53&amp;\\Longleftrightarrow-512+16b_Q+c_Q=54\\land-800+20b_Q+c_Q=53\\\\\n&amp;\\Longleftrightarrow b_Q=\\frac{287}{4}\\land c_Q=-582\n\\end{align}\nTherefore,\nQ(x)=-2x^2+\\frac{287}{4}x-582\nTherefore,\n\\begin{align}\nP(0)+Q(0)&amp;=698-582\\\\\n&amp;=116\n\\end{align}\nProblem 7\nFor certain real numbers a, b, and c, the polynomial\ng(x)=x^3+ax^2+x+10\nhas three distinct roots, and each root of g(x) is also a root of the polynomial\nf(x)=x^4+x^3+bx^2+100x+c\nSolution 7\nLet x_0 be the additional root of f(x), then\n\\begin{align}\nf(x)&amp;=(x-x_0)g(x)\\\\\n&amp;=(x-x_0)(x^3+ax^2+x+10)\\\\\n&amp;=x^4+(a-x_0)x^3+(1-ax_0)x^2+(10-x_0)x-10x_0\n\\end{align}\nTherefore,\na-x_0=1\\land1-ax_0=b\\land10-x_0=100\\land-10x_0=c\na-x_0=1\\land1-ax_0=b\\land10-x_0=100\\land-10x_0=c\\Longleftrightarrow x_0=-90\\land a=-89\\land b=-8009\\land c=900\nTherefore,\nf(x)=x^4+x^3-8009x^2+100x+900\nTherefore, f(1)=-7007.\nProblem 8\nThere are nonzero integers a, b, r and s such that the complex number r+si is a zero of the polynomial P(x)=x^3-ax^2+bx-65. For each possible combination of a and b, let \\rho_{a,b} be the sum of the zeros of P(x). Find the sum of the \\rho_{a,b}‘s for all possible combinations of a and b.\nSolution 8\nIt is easy to prove that the problem is equivalent to finding the sum of the sum of zeros of all P(x)\\in\\R[x] such that\n\\exist r,s\\in\\Z\\setminus\\{0\\},P(r+si)=0\\land\\exist a,b\\in\\Z\\setminus\\{0\\},P(x)=x^3-ax^2+bx-65\nSince P(x)\\in\\R[x], it follows that\nP(r+si)=0\\Longleftrightarrow P(r-si)=0\nTherefore,\n\\begin{align}\n\\exist r,s\\in\\Z\\setminus\\{0\\},P(r+si)=0&amp;\\Longleftrightarrow\\exist r,s\\in\\Z\\setminus\\{0\\},\\exist t\\in\\R,P(x)=(x-r+si)(x-r-si)(x-t)\\\\\n&amp;\\Longleftrightarrow\\exist r,s\\in\\Z\\setminus\\{0\\},\\exist t\\in\\R,P(x)=x^3-(2r+t)x^2+(r^2+s^2+2rt)x-(r^2+s^2)t\n\\end{align}\nTherefore,\n\\begin{align}\n\\exist r,s\\in\\Z\\setminus\\{0\\},P(r+si)=0\\land\\exist a,b\\in\\Z\\setminus\\{0\\},P(x)=x^3-ax^2+bx-65&amp;\\Longleftrightarrow\\exist r,s\\in\\Z\\setminus\\{0\\},\\exist t\\in\\R,P(x)=x^3-(2r+t)x^2+(r^2+s^2+2rt)x-(r^2+s^2)t\\land2r+t\\in\\Z\\setminus\\{0\\}\\land r^2+s^2+2rt\\in\\Z\\setminus\\{0\\}\\land(r^2+s^2)t=65\\\\\n&amp;\\Longleftrightarrow\\exist r,s\\in\\Z\\setminus\\{0\\},\\exist t\\in\\Z_+,P(x)=x^3-(2r+t)x^2+(r^2+s^2+2rt)x-(r^2+s^2)t\\land(r^2+s^2)t=65\\\\\n&amp;\\Longleftrightarrow\\exist\\langle r,s,t\\rangle\\in\\{\\langle1,2,13\\rangle,\\langle2,1,13\\rangle,\\langle-1,-2,13\\rangle,\\langle-2,-1,13\\rangle,\\langle2,3,5\\rangle,\\langle3,2,5\\rangle,\\langle-2,-3,5\\rangle,\\langle-3,-2,5\\rangle,\\langle1,8,1\\rangle,\\langle8,1,1\\rangle,\\langle-1,-8,1\\rangle,\\langle-8,-1,1\\rangle\\,\\langle4,7,1\\rangle,\\langle7,4,1\\rangle,\\langle-4,-7,1\\rangle,\\langle-7,-4,1\\rangle\\},P(x)=(x-r+si)(x-r-si)(x-t)\n\\end{align}\nTherefore, the sum of the sum of zeros of P(x) is 80.\nProblem 9\nFind all polynomials f(x) with real coefficients such that f(x^2)=f(x)^2.\nSolution 9\n\\begin{align}\nf(x^2)=f(x)^2&amp;\\Longrightarrow\\forall x\\in\\mathbb{C},f(x^2)=0\\leftrightarrow f(x)^2=0\\\\\n&amp;\\Longleftrightarrow\\forall x\\in\\mathbb{C},f(x^2)=0\\leftrightarrow f(x)=0\n\\end{align}\nTherefore, if \\exist x\\in\\C\\setminus\\{-1,0,1\\},f(x)=0, infinitely many distinct numbers\nx,x^2,x^4,x^8,\\dots\nare all zeros of f(x). If \\exist x\\in\\{0,1\\},f(x)=0, infinitely many distinct numbers\ne^{i\\pi},e^\\frac{i\\pi}{2},e^\\frac{i\\pi}{4},e^\\frac{i\\pi}{8},\\dots\nare all zeros of f(x). Therefore,\n\\begin{align}\nf(x^2)=f(x)^2&amp;\\Longrightarrow f(x)=0\\lor\\forall x\\in\\mathbb{C}\\setminus\\{0\\},f(x)\\ne0\\\\\n&amp;\\Longleftrightarrow\\exist a\\in\\R,\\exist n\\in\\N,f(x)=ax^n\n\\end{align}\nTherefore,\n\\begin{align}\nf(x^2)=f(x)^2&amp;\\Longleftrightarrow\\exist a\\in\\R,\\exist n\\in\\N,f(x)=ax^n\\land ax^{2n}=a^2x^{2n}\\\\\n&amp;\\Longleftrightarrow\\exist a\\in\\R,\\exist n\\in\\N,f(x)=ax^n\\land(a=0\\lor a=1)\\\\\n&amp;\\Longleftrightarrow f(x)=0\\lor\\exist n\\in\\N,f(x)=x^n\n\\end{align}\nProblem 10\nThere exist two triples of real numbers \\langle a,b,c\\rangle such that a-\\frac{1}{b}, b-\\frac{1}{c}, and c-\\frac{1}{a} are the roots to the cubic equation x^3-5x^2-15x+3 listed in increasing order. Denote those \\langle a_1,b_1,c_1\\rangle and \\langle a_2,b_2,c_2\\rangle. If a_1, b_1 and c_1 are the roots to monic cubic polynomial f and a_2, b_2 and c_2 are the roots to monic cubic polynomial g, find f(0)^3+g(0)^3.\nSolution 10\nApplying Vieta’s Lemma yields\n\\left(a-\\frac{1}{b}\\right)\\left(b-\\frac{1}{c}\\right)\\left(c-\\frac{1}{a}\\right)=-3\n\\left(a-\\frac{1}{b}\\right)\\left(b-\\frac{1}{c}\\right)\\left(c-\\frac{1}{a}\\right)=-3\\Longleftrightarrow abc-a-b-c+\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}-\\frac{1}{abc}=-3\nApplying Vieta’s Lemma yields\na-\\frac{1}{b}+b-\\frac{1}{c}+c-\\frac{1}{a}=5\nTherefore,\nabc-\\frac{1}{abc}=2\n\\begin{align}\nabc-\\frac{1}{abc}=2&amp;\\Longleftrightarrow(abc)^2-2abc-1=0\\\\\n&amp;\\Longleftrightarrow abc=1-\\sqrt2\\lor abc=1+\\sqrt2\n\\end{align}\nApplying Vieta’s Lemma yields\nf(0)=-a_1b_1c_1,g(0)=-a_2b_2c_2\nIt is easy to prove that f(0)\\ne g(0), therefore\n\\begin{align}\nf(0)^3+g(0)^3&amp;=\\left(-\\left(1-\\sqrt2\\right)\\right)^3+\\left(-\\left(1+\\sqrt2\\right)\\right)^3\\\\\n&amp;=-14\n\\end{align}\nProblem 11\nFind all possible values of a such that the roots of polynomial x^3-6x^2+ax+a (denote by x_1,x_2,x_3) satisfy that (x_1-3)^3+(x_2-3)^3+(x_3-3)^3=0.\nSolution 11\nApplying Newton’s Identities yields\nx_1+x_2+x_3=6\n\\begin{align}\nx_1^2+x_2^2+x_3^2&amp;=6(x_1+x_2+x_3)-2a\\\\\n&amp;=36-2a\n\\end{align}\n\\begin{align}\nx_1^3+x_2^3+x_3^3&amp;=6(x_1^2+x_2^2+x_3^2)-a(x_1+x_2+x_3)-3a\\\\\n&amp;=216-21a\n\\end{align}\nTherefore,\n\\begin{align}\n(x_1-3)^3+(x_2-3)^3+(x_3-3)^3&amp;=x_1^3+x_2^3+x_3^3-9(x_1^2+x_2^2+x_3^2)+27(x_1+x_2+x_3)-81\\\\\n&amp;=-3a-27\n\\end{align}\nTherefore,\n\\begin{align}\n(x_1-3)^3+(x_2-3)^3+(x_3-3)^3=0&amp;\\Longleftrightarrow-3a-27=0\\\\\n&amp;\\Longleftrightarrow a=-9\n\\end{align}\nProblem 12\nIf r, s, t and u denote the roots of the polynomial f(x)=x^4+3x^3+3x+2, evaluate \\frac{1}{r^2}+\\frac{1}{s^2}+\\frac{1}{t^2}+\\frac{1}{u^2}.\nSolution 12\nLet\n\\begin{align}\ng(x)&amp;=x^nf(x^{-1})\\\\\n&amp;=2x^4+3x^3+3x+1\n\\end{align}\nthen, since\n\\begin{align}\ng(x)&amp;=x^nf(x^{-1})\\\\\n&amp;=(rx-1)(sx-1)(tx-1)(ux-1)\n\\end{align}\ng(x) is a polynomial with roots \\frac{1}{r}, \\frac{1}{s}, \\frac{1}{t} and \\frac{1}{u}.\nApplying Newton’s Identities yields\n\\frac{1}{r}+\\frac{1}{s}+\\frac{1}{t}+\\frac{1}{u}=-\\frac{3}{2}\n\\begin{align}\n\\frac{1}{r^2}+\\frac{1}{s^2}+\\frac{1}{t^2}+\\frac{1}{u^2}&amp;=-\\frac{3}{2}\\left(\\frac{1}{r}+\\frac{1}{s}+\\frac{1}{t}+\\frac{1}{u}\\right)\\\\\n&amp;=\\frac{9}{4}\n\\end{align}\nProblem 13\nFind all polynomials of degree less than 4 satisfying that f(0)=1,f(1)=1,f(2)=5,f(3)=11.\nSolution 13\nIt is easy to prove the problem is equivalent to finding all polynomials f(x) such that\n\\exist a,b,c,d\\in\\Z,f(x)=ax^3+bx^2+cx+d\\land f(0)=1\\land f(1)=1\\land f(2)=5\\land f(3)=11\n\\begin{align}\n\\exist a,b,c,d\\in\\Z,f(x)=ax^3+bx^2+cx+d\\land f(0)=1\\land f(1)=1\\land f(2)=5\\land f(3)=11&amp;\\Longleftrightarrow\\exist a,b,c,d\\in\\Z,f(x)=ax^3+bx^2+cx+d\\land d=1\\land a+b+c+d=1\\land 8a+4b+2c+d=5\\land 27a+9b+3c+d=11\\\\\n&amp;\\Longleftrightarrow\\exist a,b,c,d\\in\\Z,f(x)=ax^3+bx^2+cx+d\\land a=-\\frac{1}{3}\\land b=3\\land c=-\\frac{8}{3}\\land d=1\\\\\n&amp;\\Longleftrightarrow f(x)=-\\frac{1}{3}x^3+3x^2-\\frac{8}{3}x+1\n\\end{align}\nProblem 14\nWhat is the sum of the roots of z^{12}=64 that have a positive real part?\nSolution 14\nThe roots of z^{12}=64 are\nz_k=\\sqrt2\\left(\\cos\\left(\\frac{k\\pi}{6}\\right)+i\\sin\\left(\\frac{k\\pi}{6}\\right)\\right),k=0,1,\\dots,11\nSince\n\\cos\\left(\\frac{k\\pi}{6}\\right)&gt;0\\Longleftrightarrow k\\in\\{0,1,2,10,11\\}\nIt follows that the roots with a positive real part are z_0,z_1,z_2,z_{10},z_{11}.\n\\begin{align}\n\\sum_{k\\in\\{0,1,2,10,11\\}}z_k&amp;=\\sqrt2\\sum_{k\\in\\{0,1,2,10,11\\}}\\cos\\left(\\frac{k\\pi}{6}\\right)+\\sqrt2i\\sum_{k\\in\\{0,1,2,10,11\\}}\\sin\\left(\\frac{k\\pi}{6}\\right)\\\\\n&amp;=\\sqrt2\\left(\\cos(0)+2\\cos\\left(\\frac{\\pi}{6}\\right)+2\\cos\\left(\\frac{\\pi}{3}\\right)\\right)\\\\\n&amp;=2\\sqrt2+\\sqrt6\n\\end{align}\nProblem 15\nThe equation x^2-2ax+a^2-4a=0,a\\in\\R has at least one root with magitude 3. Find all possible values of a.\nSolution 15\nLet f(x)=x^2-2ax+a^2-4a, then it is easy to prove that the problem is equivalent to finding all possible values of a such that\n\\exist x\\in\\mathbb C,|x|=3\\land f(x)=0\n\\exist x\\in\\mathbb C,|x|=3\\land f(x)=0\\Longleftrightarrow(\\exist x\\in\\R,|x|=3\\land f(x)=0)\\lor(\\exist x\\in\\mathbb C\\setminus\\R,|x|=3\\land f(x)=0)\n\\begin{align}\n\\exist x\\in\\R,|x|=3\\land f(x)=0&amp;\\Longleftrightarrow\\exist x\\in\\{-3,3\\},f(x)=0\\\\\n&amp;\\Longleftrightarrow a^2+2a+9=0\\lor a^2-10a+9=0\\\\\n&amp;\\Longleftrightarrow a=1\\lor a=9\\\\\n\\end{align}\nSince f(x)\\in\\R[x], it follows that\nf(x)=0\\Longleftrightarrow f(\\overline x)=0\nTherefore, applying Vieta’s Formulas yields\n\\begin{align}\n\\exist x\\in\\mathbb C\\setminus\\R,|x|=3\\land f(x)=0&amp;\\Longleftrightarrow \\exist x\\in\\mathbb C\\setminus\\R,|x|=3\\land x+\\overline{x}=2a\\land x\\overline{x}=a^2-4a\\\\\n&amp;\\Longleftrightarrow \\exist x\\in\\mathbb C\\setminus\\R,|x|=3\\land\\Re(x)=a\\land|x|^2=a^2-4a\\\\\n&amp;\\Longleftrightarrow a^2-4a=9\\land\\exist x\\in\\mathbb C\\setminus\\R,|x|=3\\land\\Re(x)=a\\\\\n&amp;\\Longleftrightarrow a^2-4a-9=0\\land-3\\le a\\le3\\\\\n&amp;\\Longleftrightarrow a=2-\\sqrt{13}\n\\end{align}\nTherefore,\n\\exist x\\in\\mathbb C,|x|=3\\land f(x)=0\\Longleftrightarrow a=1\\lor a=9\\lor a=2-\\sqrt{13}\nProblem 16\nLet z=a+bi be the complex number with |z|=5 and b&gt;0 such that the distance between (1+2i)z^3 and z^5 is maximized, and let z^4=c+di. Find c+d.\nSolution 16\n\\begin{align}\n\\operatorname*{argmax}_{|z|=5\\land\\Im(z)&gt;0}\\left|(1+2i)z^3-z^5\\right|&amp;=\\operatorname*{argmax}_{|z|=5\\land\\Im(z)&gt;0}|z|^3\\left|1+2i-z^2\\right|\\\\\n&amp;=\\operatorname*{argmax}_{|z|=5\\land\\Im(z)&gt;0}\\left|1+2i-z^2\\right|\\\\\n&amp;=\\left\\{\\sqrt{-25\\frac{1+2i}{|1+2i|}}\\right\\}\\\\\n&amp;=\\left\\{\\sqrt{-5\\sqrt5(1+2i)}\\right\\}\n\\end{align}\nTherefore,\nz=\\sqrt{-5\\sqrt5(1+2i)}\nTherefore,\n\\begin{align}\nz^4&amp;=\\left(-5\\sqrt5(1+2i)\\right)^2\\\\\n&amp;=-375+500i\n\\end{align}\nTherefore, c+d=125.\nProblem 17\nEvaluate\n\\sum_{n=0}^\\infty\\frac{\\cos(n\\theta)}{2^n}\nwhere \\cos(\\theta)=\\frac{1}{5}.\nSolution 17\n\\begin{align}\n\\sum_{n=0}^\\infty\\frac{\\cos(n\\theta)}{2^n}&amp;=\\sum_{n=0}^\\infty\\frac{\\Re(e^{in\\theta})}{2^n}\\\\\n&amp;=\\Re\\left(\\sum_{n=0}^\\infty\\left(\\frac{e^{i\\theta}}{2}\\right)^n\\right)\\\\\n&amp;=2\\Re\\left(\\frac{1}{2-e^{i\\theta}}\\right)\\\\\n&amp;=2\\Re\\left(\\frac{2-\\cos(\\theta)+i\\sin(\\theta)}{(2-\\cos(\\theta))^2+\\sin(\\theta)^2}\\right)\\\\\n&amp;=\\frac{4-2\\cos(\\theta)}{(2-\\cos(\\theta))^2+1-\\cos(\\theta)^2}\\\\\n&amp;=\\frac{4-2\\cos(\\theta)}{(2-\\cos(\\theta))^2+1-\\cos(\\theta)^2}\\\\\n&amp;=\\frac{6}{7}\n\\end{align}\nProblem 18\nLet \\omega\\ne1 be a 13th root of unity. Find the remainder when \\prod_{k=0}^{12}(2-2\\omega^k+\\omega^{2k}) is divided by 1000.\nSolution 18\n\\begin{align}\n\\prod_{k=0}^{12}(2-2\\omega^k+\\omega^{2k})&amp;=\\prod_{x^{13}-1=0}(x^2-2x+2)\\\\\n&amp;=\\prod_{x^{13}-1=0}\\prod_{y^2-2y+2=0}(x-y)\\\\\n&amp;=\\prod_{y^2-2y+2=0}\\prod_{x^{13}-1=0}(y-x)\\\\\n&amp;=\\prod_{y^2-2y+2=0}(y^{13}-1)\\\\\n&amp;=((1-i)^{13}-1)((1+i)^{13}-1)\\\\\n&amp;=8321\n\\end{align}\nThe remainder when 8321 is divided by 1000 is 321.\nProblem 19\nThe polynomial f(z)=az^{2018}+bz^{2017}+cz^{2016} has real coefficients not exceeding 2019, and f\\left(\\frac{1+\\sqrt3i}{2}\\right)=2015+2019\\sqrt3i. Find the remainder when f(1) is divided by 1000.\nSolution 19\nSince \\left(\\frac{1+\\sqrt3i}{2}\\right)^6=1, it follows that\n\\begin{align}\nf\\left(\\frac{1+\\sqrt3i}{2}\\right)&amp;=a\\left(\\frac{1+\\sqrt3i}{2}\\right)^{2018}+b\\left(\\frac{1+\\sqrt3i}{2}\\right)^{2017}+c\\left(\\frac{1+\\sqrt3i}{2}\\right)^{2016}\\\\\n&amp;=a\\left(\\frac{-1+\\sqrt3i}{2}\\right)+b\\left(\\frac{1+\\sqrt3i}{2}\\right)+c\\\\\n&amp;=-\\frac{a}{2}+\\frac{b}{2}+c+\\left(\\frac{a}{2}+\\frac{b}{2}\\right)\\sqrt3i\n\\end{align}\nTherefore,\n\\begin{align}\nf\\left(\\frac{1+\\sqrt3i}{2}\\right)=2015+2019\\sqrt3i&amp;\\Longleftrightarrow-\\frac{a}{2}+\\frac{b}{2}+c+\\left(\\frac{a}{2}+\\frac{b}{2}\\right)\\sqrt3i=2015+2019\\sqrt3i\\\\\n&amp;\\Longleftrightarrow-\\frac{a}{2}+\\frac{b}{2}+c=2015\\land\\frac{a}{2}+\\frac{b}{2}=2019\\\\\n&amp;\\Longleftrightarrow a=2019\\land b=2019\\land c=2015\\\\\n\\end{align}\nTherefore,\n\\begin{align}\nf(1)&amp;=a+b+c\\\\\n&amp;=6053\n\\end{align}\nThe remainder when 6053 is divided by 1000 is 53.\nProblem 20\nFind the largest possible real part of (75+117i)z+\\frac{96+144i}{z} where z is a complex number with |z|=4.\nSolution 20\n\\begin{align}\n\\max_{|z|=4}\\Re\\left((75+117i)z+\\frac{96+144i}{z}\\right)&amp;=\\max_\\theta\\Re((300+468i)e^{i\\theta}+(24+36i)e^{-i\\theta})\\\\\n&amp;=\\max_\\theta(324\\cos(\\theta)-432\\sin(\\theta))\n\\end{align}\nApplying Cauchy-Schwarz Inequality yields\n\\begin{align}\n324\\cos(\\theta)-432\\sin(\\theta)&amp;\\le\\sqrt{(324^2+432^2)(\\cos(\\theta)^2+\\sin(\\theta)^2)}\\\\\n&amp;=540\n\\end{align}\nand when \\theta=-\\arctan\\left(\\frac{4}{3}\\right), 324\\cos(\\theta)-432\\sin(\\theta)=540. Therefore,\n\\max_\\theta(324\\cos(\\theta)-432\\sin(\\theta))=540\nProblem 21\nLet a,b,c,d be real numbers such that b-d\\ge5 and all zeros x_1,x_2,x_3,x_4 of the polynomial\nP(x)=x^4+ax^3+bx^2+cx+d\nare real. Find the smallest possible value of the product\n(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1)\nSolution 21\n\\begin{align}\n(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1)&amp;=(i-x_1)(-i-x_1)(i-x_2)(-i-x_2)(i-x_3)(-i-x_3)(i-x_4)(-i-x_4)\\\\\n&amp;=P(i)P(-i)\\\\\n&amp;=(b-d-1+(a-c)i)(b-d+1-(a-c)i)\\\\\n&amp;=(b-d-1)^2+(a-c)^2\n\\end{align}\nTherefore, the smallest possible value of the product is 16.\nProblem 22\nLet N be the number of complex numbers z with the properties that |z|=1 and z^{6!}-z^{5!} is a real number. Find the remainder when N is divided by 1000.\nSolution 22\n\\begin{align}\nN&amp;=|\\{z:z\\in\\mathbb{C}\\land|z|=1\\land z^{6!}-z^{5!}\\in\\R\\}|\\\\\n&amp;=|\\{\\theta:\\theta\\in[0,2\\pi)\\land e^{6!i\\theta}-e^{5!i\\theta}\\in\\R\\}|\n\\end{align}\n\\begin{align}\ne^{6!i\\theta}-e^{5!i\\theta}\\in\\R&amp;\\Longleftrightarrow\\sin(6!\\theta)-\\sin(5!\\theta)=0\\\\\n&amp;\\Longleftrightarrow2\\cos(420\\theta)\\sin(300\\theta)=0\\\\\n&amp;\\Longleftrightarrow\\cos(420\\theta)=0\\lor\\sin(300\\theta)=0\\\\\n&amp;\\Longleftrightarrow\\left(\\exist n\\in\\Z,\\theta=\\frac{(2n+1)\\pi}{840}\\right)\\lor\\left(\\exist n\\in\\Z,\\theta=\\frac{n\\pi}{300}\\right)\n\\end{align}\nTherefore,\n\\begin{align}\nN&amp;=\\left|\\left\\{\\frac{1\\pi}{840},\\frac{3\\pi}{840},\\dots,\\frac{1679\\pi}{840}\\right\\}\\cup\\left\\{\\frac{0\\pi}{300},\\frac{1\\pi}{300},\\dots,\\frac{599\\pi}{300}\\right\\}\\right|\\\\\n&amp;=|\\{1,3,\\dots,1679\\}|+|\\{0,1,\\dots,599\\}|\\\\\n&amp;=1440\n\\end{align}\nTherefore, the remainder when N is divided by 1000 is 440.\nProblem 23\nEvaluate the following sums:\n(a)\n\\binom{48}{0}+\\binom{48}{3}+\\dots+\\binom{48}{48}\n(b)\n\\binom{48}{0}+\\binom{48}{4}+\\dots+\\binom{48}{48}\nSolution 23\n(a)\n\\begin{align}\n\\binom{48}{0}+\\binom{48}{3}+\\dots+\\binom{48}{48}&amp;=\\sum_{n=0}^{48}\\binom{48}{n}[3\\mid n]\\\\\n&amp;=\\frac{1}{3}\\sum_{n=0}^{48}\\binom{48}{n}\\sum_{k=0}^2\\omega_3^{kn}\\\\\n&amp;=\\frac{1}{3}\\sum_{k=0}^2\\sum_{n=0}^{48}\\binom{48}{n}(\\omega_3^k)^n\\\\\n&amp;=\\frac{1}{3}\\sum_{k=0}^2(1+\\omega_3^k)^{48}\\\\\n&amp;=\\frac{2^{48}+\\left(\\frac{1+\\sqrt3i}{2}\\right)^{48}+\\left(\\frac{1-\\sqrt3i}{2}\\right)^{48}}{3}\\\\\n&amp;=\\frac{2^{48}+2}{3}\\\\\n\\end{align}\n(b)\n\\begin{align}\n\\binom{48}{0}+\\binom{48}{4}+\\dots+\\binom{48}{48}&amp;=\\sum_{n=0}^{48}\\binom{48}{n}[4\\mid n]\\\\\n&amp;=\\frac{1}{4}\\sum_{n=0}^{48}\\binom{48}{n}\\sum_{k=0}^3\\omega_4^{kn}\\\\\n&amp;=\\frac{1}{4}\\sum_{k=0}^3\\sum_{n=0}^{48}\\binom{48}{n}(\\omega_4^k)^n\\\\\n&amp;=\\frac{1}{4}\\sum_{k=0}^3(1+\\omega_4^k)^{48}\\\\\n&amp;=\\frac{2^{48}+(1+i)^{48}+0^{48}+(1-i)^{48}}{4}\\\\\n&amp;=\\frac{2^{48}+2^{25}}{4}\\\\\n\\end{align}"},"PRISMS-Math-Team-Training/20250929-PRISMS-Senior-Varsity-Training":{"slug":"PRISMS-Math-Team-Training/20250929-PRISMS-Senior-Varsity-Training","filePath":"PRISMS Math Team Training/20250929 PRISMS Senior Varsity Training.md","title":"20250929 PRISMS Senior Varsity Training","links":[],"tags":[],"content":"Problem 1\nEquilateral \\triangle ABC with side length 14 is rotated about its center by angle \\theta, where 0&lt;\\theta&lt;60\\degree, to form \\triangle DEF. The area of hexagon ADBECF is 91\\sqrt3. What is \\tan(\\theta)?\nSolution 1\nLet O be the center of \\triangle ABC, then it is easy to prove that\n\\begin{align}\n|OA|&amp;=\\frac{\\sqrt3}{3}|AB|\\\\\n&amp;=\\frac{14\\sqrt3}{3}\n\\end{align}\nIt is easy to prove that\n\\begin{align}\n[ADBECF]&amp;=3[\\triangle OAD]+3[\\triangle OAF]\\\\\n&amp;=\\frac{3}{2}|OA|^2\\sin(\\theta)+\\frac{3}{2}|OA|^2\\sin(120\\degree-\\theta)\\\\\n&amp;=98\\sin(\\theta)+98\\sin(120\\degree-\\theta)\n\\end{align}\nTherefore,\n\\begin{align}\n[ADBECF]=91\\sqrt3&amp;\\Longleftrightarrow\\sin(\\theta)+\\sin(120\\degree-\\theta)=\\frac{91\\sqrt3}{98}\\\\\n&amp;\\Longleftrightarrow\\frac{1}{2}\\cos(\\theta)+\\frac{\\sqrt3}{2}\\sin(\\theta)=\\frac{91}{98}\\\\\n&amp;\\Longleftrightarrow\\sin(\\theta+30\\degree)=\\frac{91}{98}\\\\\n&amp;\\Longleftrightarrow\\tan(\\theta+30\\degree)=\\frac{13\\sqrt3}{9}\\\\\n&amp;\\Longleftrightarrow\\tan(\\theta)=\\frac{5\\sqrt3}{11}\\\\\n\\end{align}\nProblem 2\nSuppose A, B and C are points in the plane with |AB|=40 and |AC|=42, and let x be the length of the line segment from A to the midpoint of \\overline{BC}. Define a function f by letting f(x) be the area of \\triangle ABC. Then the domain of f is an open interval (p,q), and the maximum value r of f(x) occurs at x=s. What is p+q+r+s?\nSolution 2\nApplying the Triangle Inequality yields that A, B and C forms a triangle iff\n||AB|-|AC||&lt;|BC|&lt;|AB|+|AC|\\Longleftrightarrow2&lt;|BC|&lt;82\nApplying Apollonius’s Theorem yields\n\\begin{align}\nx&amp;=\\frac{1}{2}\\sqrt{2|AB|^2+2|AC|^2-|BC|^2}\\\\\n&amp;=\\frac{1}{2}\\sqrt{6728-|BC|^2}\\\\\n\\end{align}\nTherefore, A, B and C forms a triangle iff\n1&lt;x&lt;41\nTherefore, p=1,q=41.\n\\begin{align}\nf(x)&amp;=[\\triangle ABC]\\\\\n&amp;=\\frac{1}{2}|AB||AC|\\sin(\\angle BAC)\\\\\n&amp;=840\\sin(\\angle BAC)\n\\end{align}\nApplying the Pythagorean Theorem yields\n\\begin{align}\n\\angle BAC=90\\degree&amp;\\Longleftrightarrow|AB|^2+|AC|^2=|BC|^2\\\\\n&amp;\\Longleftrightarrow|BC|=58\\\\\n&amp;\\Longleftrightarrow x=29\\\\\n\\end{align}\nTherefore, it is easy to prove that r=840,s=29. Therefore, p+q+r+s=911.\nProblem 3\nThe measures of the smallest angles of three different right triangles sum to 90\\degree. All three triangles have side lengths that are primitive Pythagorean triples. Two of them are 3-4-5 and 5-12-13. What is the perimeter of the third triangle?\nSolution 3\nLet the smallest angles of these triangles be \\alpha, \\beta and \\gamma, respectively. Then\n\\begin{align}\n\\tan(\\gamma)&amp;=\\tan(90\\degree-\\alpha-\\beta)\\\\\n&amp;=\\cot(\\alpha+\\beta)\\\\\n&amp;=\\frac{\\cot(\\alpha)\\cot(\\beta)-1}{\\cot(\\alpha)+\\cot(\\beta)}\\\\\n&amp;=\\frac{33}{56}\n\\end{align}\nTherefore, it is easy to prove that the third triangle is a 33-56-65 triangle. Therefore, the perimeter of the third triangle is 33+56+65=154.\nProblem 4\nLet \\triangle ABC be a triangle with integer side lengths and the property that \\angle B=2\\angle A. What is the least possible perimeter of such a triangle?\nSolution 4\nApplying the Law of Sines yields\n\\frac{|AC|}{|BC|}=\\frac{\\sin(\\angle B)}{\\sin(\\angle A)}\nTherefore,\n\\begin{align}\n\\angle B=2\\angle A&amp;\\Longrightarrow\\sin(\\angle B)=\\sin(2\\angle A)\\\\\n&amp;\\Longleftrightarrow\\frac{|AC|}{|BC|}=\\frac{\\sin(2\\angle A)}{\\sin(\\angle A)}\\\\\n&amp;\\Longleftrightarrow\\frac{|AC|}{|BC|}=2\\cos(\\angle A)\n\\end{align}\nApplying the Law of Cosines yields\n\\cos(\\angle A)=\\frac{|AB|^2+|AC|^2-|BC|^2}{2|AB||AC|}\nTherefore,\n\\begin{align}\n\\angle B=2\\angle A&amp;\\Longrightarrow\\frac{|AC|}{|BC|}=\\frac{|AB|^2+|AC|^2-|BC|^2}{|AB||AC|}\\\\\n&amp;\\Longleftrightarrow|AB|=|BC|\\lor|AC|^2=|BC|(|AB|+|BC|)\n\\end{align}\nTherefore, it is easy to prove that if |AC|&lt;7, the only triangle with integer side lengths and the property that \\angle B=2\\angle A is the triangle such that |AB|=5\\land|AC|=6\\land|BC|=4. The perimeter of this triangle is 5+6+4=15.\nApplying the Triangle Inequality yields\n|AB|+|BC|&gt;|AC|\nTherefore, if |AC|\\ge7,\n\\begin{align}\n|AB|+|BC|&gt;|AC|&amp;\\Longleftrightarrow|AB|+|AC|+|BC|&gt;2|AC|\\\\\n&amp;\\Longrightarrow|AB|+|AC|+|BC|\\ge15\n\\end{align}\nTherefore, the least perimeter is 15.\nProblem 5\nA right pyramid has regular octagon ABCDEFGH with side length 1 as its base and apex V. Segments \\overline{AV} and \\overline{DV} are perpendicular. What is the square of the height of the pyramid.\nSolution 5\nLet O be the center of the octagon, X be a point on \\overline{BC} such that \\overline{OX}\\perp\\overline{BC}, Y be a point on DE such that \\overline{OY}\\perp\\overline{DE}. Set up a coordinate system by taking O as the origin, \\overrightarrow{OX} as the x-axis, \\overrightarrow{OY} as the y-axis, and \\overrightarrow{OV} as the z-axis. Then it is easy to prove that\n\\overrightarrow{OA}=\\left(\\frac{1}{2},-\\frac{1+\\sqrt2}{2},0\\right),\\overrightarrow{OD}=\\left(\\frac{1}{2},-\\frac{1+\\sqrt2}{2},0\\right),\\overrightarrow{OV}=(0,0,|OV|)\nTherefore,\n\\begin{align}\n\\overrightarrow{AV}&amp;=\\overrightarrow{OV}-\\overrightarrow{OA}\\\\\n&amp;=\\left(-\\frac{1}{2},\\frac{1+\\sqrt2}{2},|OV|\\right)\n\\end{align}\n\\begin{align}\n\\overrightarrow{DV}&amp;=\\overrightarrow{OV}-\\overrightarrow{OD}\\\\\n&amp;=\\left(-\\frac{1}{2},-\\frac{1+\\sqrt2}{2},|OV|\\right)\n\\end{align}\nTherefore,\n\\begin{align}\nAV\\perp DV&amp;\\Longleftrightarrow\\overrightarrow{AV}\\cdot\\overrightarrow{DV}=0\\\\\n&amp;\\Longleftrightarrow-\\frac{1+\\sqrt2}{2}+|OV|^2=0\\\\\n&amp;\\Longleftrightarrow|OV|^2=\\frac{1+\\sqrt2}{2}\n\\end{align}\nTherefore, the square of the height is \\frac{1+\\sqrt2}{2}.\nProblem 6\nWhat is the number of ordered triples \\langle a,b,c\\rangle of positive integers, with a\\le b\\le c\\le9, such that there exists a (non-degenerate) triangle \\triangle ABC with an integer inradius for which a, b and c are the lengths of the altitudes from A to \\overline{BC}, B to \\overline{AC}, and C to \\overline{AB}, respectively?\nSolution 6\nLet O be the incenter of \\triangle ABC, r be the length of the inradius of \\triangle ABC. Then\n\\begin{align}\n[\\triangle ABC]&amp;=[\\triangle AOB]+[\\triangle AOC]+[\\triangle BOC]\\\\\n&amp;=\\frac{1}{2}(|AB|+|AC|+|BC|)r\n\\end{align}\nSince [\\triangle ABC]=\\frac{1}{2}|AB|c, it follows that\n\\frac{r}{c}=\\frac{|AB|}{|AB|+|AC|+|BC|}\nSince [\\triangle ABC]=\\frac{1}{2}|AC|b, it follows that\n\\frac{r}{b}=\\frac{|AC|}{|AB|+|AC|+|BC|}\nSince [\\triangle ABC]=\\frac{1}{2}|BC|a, it follows that\n\\frac{r}{a}=\\frac{|BC|}{|AB|+|AC|+|BC|}\nTherefore,\n\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}=\\frac{1}{r}\nTherefore,\nr\\in\\Z\\Longleftrightarrow\\frac{1}{\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}}\\in\\Z\nTherefore, it is easy to prove that all ordered triples are \\langle3,3,3\\rangle, \\langle6,6,6\\rangle, and \\langle9,9,9\\rangle. Therefore, the number of ordered triples is 3.\nProblem 7\nCyclic quadrilateral ABCD has lengths |BC|=|CD|=3 and |AD|=5 with \\angle ADC=120\\degree. What is the length of the shorter diagonal of ABCD?\nSolution 7\nApplying the Law of Cosines yields\n|AC|^2=|AD|^2+|CD|^2-2|AD||CD|\\cos(\\angle ADC)\n|AC|^2=|AD|^2+|CD|^2-2|AD||CD|\\cos(\\angle ADC)\\Longleftrightarrow|AC|=7\nApplying the Law of Cosines yields\n|AC|^2=|AB|^2+|BC|^2-2|AB||BC|\\cos(\\angle ABC)\nSince\n\\begin{align}\n\\angle ABC&amp;=180\\degree-\\angle ADC\\\\\n&amp;=60\\degree\n\\end{align}\nit follows that\n|AC|^2=|AB|^2+|BC|^2-2|AB||BC|\\cos(\\angle ABC)\\Longleftrightarrow|AB|=8\nApplying Ptolemy’s Theorem yields\n|AC||BD|=|AB||CD|+|AD||BC|\n|AC||BD|=|AB||CD|+|AD||BC|\\Longleftrightarrow|BD|=\\frac{39}{7}\nTherefore, the length of the shorter diagonal is \\min\\{|AC|,|BD|\\}=\\frac{39}{7}.\nProblem 8\nOn top of a rectangular card with sides of length 1 and 2+\\sqrt3, an identical card is placed so that two of their diagonals line up, as shown (\\overline{AC}, in this case). Continue the process, adding a third card to the second, and so on, lining up successive diagonals after rotating clockwise. In total, how many cards must be used until a vertex of a new card lands exactly on the vertex B in the figure?\n\nSolution 8\nApplying the Pythagorean Theorem yields\n\\begin{align}\n|AC|&amp;=\\sqrt{|AB|^2+|BC|^2}\\\\\n&amp;=2\\sqrt{2+\\sqrt3}\n\\end{align}\nLet D be the midpoint of \\overline{AC}, then\n\\begin{align}\n|AD|&amp;=\\frac{1}{2}|AC|\\\\\n&amp;=\\sqrt{2+\\sqrt3}\n\\end{align}\n\\begin{align}\n|BD|&amp;=|AD|\\\\\n&amp;=\\sqrt{2+\\sqrt3}\n\\end{align}\nApplying the Law of Cosines yields\n|AB|^2=|AD|^2+|BD|^2-2|AD||BD|\\cos(\\angle ADB)\n\\begin{align}\n|AB|^2=|AD|^2+|BD|^2-2|AD||BD|\\cos(\\angle ADB)&amp;\\Longleftrightarrow\\cos(\\angle ADB)=\\frac{\\sqrt3}{2}\\\\\n&amp;\\Longleftrightarrow\\angle ADB=30\\degree\n\\end{align}\nTherefore, it is easy to prove that 6 cards must be used.\nProblem 9\n\\triangle ABC has side lengths in arithmetic progression, and the smallest side has length 6. If the triangle has an angle of 120\\degree, what is the area of \\triangle ABC?\nSolution 9\nWlog, assume |AB|\\le|AC|\\le|BC|, then it is easy to prove that |AB|=6 and \\angle A=120\\degree.\nApplying the Law of Cosines yields\n|BC|^2=|AB|^2+|AC|^2-2|AB||AC|\\cos(\\angle A)\nLet d be common difference of the arithmetic progression, then\n|BC|^2=|AB|^2+|AC|^2-2|AB||AC|\\cos(\\angle A)\\Longleftrightarrow d=4\nTherefore, |AC|=10.\nTherefore,\n\\begin{align}\n[\\triangle ABC]&amp;=\\frac{1}{2}\\sin(\\angle A)|AB||AC|\\\\\n&amp;=15\\sqrt3\n\\end{align}\nProblem 10\nA regular pentagon with area 1+\\sqrt5 is printed on paper and cut out. The five vertices of the pentagon are folded into the center of the pentagon, creating a smaller pentagon. What is the area of the new pentagon?\nSolution 10\nLet ABCDE be the pentagon, O be the center of ABCDE, M be the midpoint of \\overline{OA}, N be a point on \\overline{AB} such that \\overline{ON}\\perp\\overline{AB}, x be area of the new pentagon. Then it is easy to prove that\n\\begin{align}\n\\frac{[ABCDE]}{x}&amp;=\\left(\\frac{|ON|}{|OM|}\\right)^2\\\\\n&amp;=\\left(\\frac{2|ON|}{|OA|}\\right)^2\\\\\n&amp;=(2\\sin(\\angle AON))^2\\\\\n&amp;=4\\sin(54\\degree)^2\n\\end{align}\nSince\n\\begin{align}\n\\cos(54\\degree)=\\sin(36\\degree)&amp;\\Longleftrightarrow\\cos(18\\degree)^3-3\\sin(18\\degree)^2\\cos(18\\degree)=2\\sin(18\\degree)\\cos(18\\degree)\\\\\n&amp;\\Longleftrightarrow4\\sin(18\\degree)^2+2\\sin(18\\degree)-1=0\\\\\n&amp;\\Longleftrightarrow\\sin(18\\degree)=\\frac{-1+\\sqrt5}{4}\n\\end{align}\nit follows that\n\\begin{align}\n\\sin(54\\degree)&amp;=\\cos(36\\degree)\\\\\n&amp;=1-2\\sin(18\\degree)^2\\\\\n&amp;=\\frac{1+\\sqrt5}{4}\n\\end{align}\nTherefore,\n\\begin{align}\nx&amp;=\\frac{[ABCDE]}{4\\sin(54\\degree)^2}\\\\\n&amp;=-1+\\sqrt5\n\\end{align}\nProblem 11\nLet \\triangle PQR be a triangle with \\angle P=75\\degree and \\angle Q=60\\degree. A regular hexagon ABCDEF with side length 1 is drawn inside \\triangle PQR so that side \\overline{AB} lies on \\overline{PQ}, side \\overline{CD} lies on \\overline{QR}, and one of the remaining vertices lies on \\overline{PR}. There are positive integers a, b, c, and d such that the area of \\triangle PQR can be expressed in the form \\frac{a+b\\sqrt{c}}{d}, where a and d are relatively prime, and c is not divisible by the square of any prime. Find a+b+c+d.\nSolution 11\nApplying the Law of Sines yields\n\\begin{align}\n\\frac{|PA|}{|PF|}&amp;=\\frac{\\sin(\\angle PFA)}{\\sin(\\angle APF)}\\\\\n&amp;=\\frac{\\sin(45\\degree)}{\\sin(75\\degree)}\\\\\n\\end{align}\nSince\n\\begin{align}\n\\sin(75\\degree)&amp;=\\cos(15\\degree)\\\\\n&amp;=\\sqrt{\\frac{1+\\cos(30\\degree)}{2}}\\\\\n&amp;=\\frac{\\sqrt2+\\sqrt6}{4}\n\\end{align}\nit follows that\n|PA|=-1+\\sqrt3\nTherefore,\n\\begin{align}\n|PQ|&amp;=|PA|+|AB|+|BQ|\\\\\n&amp;=1+\\sqrt3\n\\end{align}\nSince\n\\angle PAF=\\angle Q\\Longleftrightarrow\\triangle PAF\\sim\\triangle PQR\nit follows that\n\\begin{align}\n\\frac{[\\triangle PQR]}{[\\triangle PAF]}&amp;=\\left(\\frac{|PQ|}{|PA|}\\right)^2\\\\\n&amp;=7+4\\sqrt3\n\\end{align}\nSince\n\\begin{align}\n[\\triangle PAF]&amp;=\\frac{1}{2}\\sin(\\angle PAF)|PA||AF|\\\\\n&amp;=\\frac{3-\\sqrt3}{4}\n\\end{align}\nit follows that\n[\\triangle PQR]=\\frac{9+5\\sqrt3}{4}\nTherefore, a+b+c+d=21.\nProblem 12\nIn the figure below, semicircles with centers at A and B and with radii 2 and 1, respectively, are drawn in the interior of, and sharing bases with, a semicircle with diameter \\overline{JK}. The two smaller semicircles are externally tangent to each other and internally tangent to the largest semicircle. A circle centered at P is drawn externally tangent to the two smaller semicircles and internally tangent to the largest semicircle. What is the radius of the circle centered at P?\n\nSolution 12\nLet O be the center of the largest semicircle, r be the length of the radius of \\odot P, then it is easy to prove that |AB|=3,|OA|=1,|OB|=2,|AP|=2+r,|BP|=1+r,|OP|=3-r.\nApplying Steward’s Theorem yields\n|AP|^2|OB|+|BP|^2|OA|=|OP|^2|AB|+|OA||OB||AB|\n|AP|^2|OB|+|BP|^2|OA|=(|OP|^2+|OA||OB|)|AB|\\Longleftrightarrow r=\\frac{6}{7}\nProblem 13\nPoint B is on \\overline{AC} with |AB|=9 and |BC|=21. Point D is not on \\overline{AC} so that |AD|=|CD|, and |AD| and |BD| are integers. Let s be the sum of all possible perimeters of \\triangle ACD. Find s.\nSolution 13\nLet E be the midpoint of \\overline{AC}, then applying the Pythagorean Theorem yields\n|AD|^2-|AE|^2=|DE|^2,|BD|^2-|BE|^2=|DE|^2\nTherefore,\n(|AD|-|BD|)(|AD|+|BD|)=189\nTherefore, it is easy to prove that\n|AD|\\in\\Z\\land|BD|\\in\\Z\\Longleftrightarrow|AD|=95\\lor|AD|=33\\lor|AD|=17\nTherefore, s=380.\nProblem 14\nIn \\triangle ABC, |AB|=13, |AC|=14, and |BC|=15. Point D is on \\overline{BC} with |CD|=6. Point E is on \\overline{BC} such that \\angle BAE=\\angle CAD. Given that |BE|=\\frac{p}{q} where p and q are relatively prime positive integers, find q.\nSolution 14\n\\begin{align}\n\\frac{|BE|}{|CE|}&amp;=\\frac{[\\triangle ABE]}{[\\triangle ACE]}\\\\\n&amp;=\\frac{\\frac{1}{2}\\sin(\\angle BAE)|AB||AE|}{\\frac{1}{2}\\sin(\\angle CAE)|AC||AE|}\\\\\n&amp;=\\frac{13\\sin(\\angle BAE)}{14\\sin(\\angle CAE)}\n\\end{align}\nSince\n\\begin{align}\n\\frac{|BD|}{|CD|}&amp;=\\frac{[\\triangle ABD]}{[\\triangle ACD]}\\\\\n&amp;=\\frac{\\frac{1}{2}\\sin(\\angle BAD)|AB||AD|}{\\frac{1}{2}\\sin(\\angle CAD)|AC||AD|}\\\\\n&amp;=\\frac{13\\sin(\\angle BAD)}{14\\sin(\\angle CAD)}\n\\end{align}\nit follows that\n\\begin{align}\n\\frac{\\sin(\\angle BAE)}{\\sin(\\angle CAE)}&amp;=\\frac{\\sin(\\angle CAD)}{\\sin(\\angle BAD)}\\\\\n&amp;=\\frac{13|CD|}{14|BD|}\\\\\n&amp;=\\frac{13}{21}\n\\end{align}\nTherefore,\n\\frac{|BE|}{|CE|}=\\frac{169}{294}\n\\begin{align}\n\\frac{|BE|}{|CE|}=\\frac{169}{294}&amp;\\Longleftrightarrow|BE|=\\frac{169}{463}|BC|\\\\\n&amp;\\Longleftrightarrow|BE|=\\frac{2535}{463}\n\\end{align}\nTherefore, q=463."},"index":{"slug":"index","filePath":"index.md","title":"Welcome to My Blog!","links":[],"tags":[],"content":"Hi! I am Dong Xing, a sophomore at Princeton International School of Mathematics and Science.\nHonors and Achievements\n\nUSACO Platinum Division (2025 - Present)\n"},"文化课/2025-高考数学（北京）压轴题另解":{"slug":"文化课/2025-高考数学（北京）压轴题另解","filePath":"文化课/2025 高考数学（北京）压轴题另解.md","title":"2025 高考数学（北京）压轴题另解","links":[],"tags":[],"content":"思路来自柳宏谦。\n设顶点集 V = \\{\\langle x, y \\rangle : x \\in \\{1, 2, \\dots, 8\\} \\land y \\in \\{1, 2, \\dots, 8\\}\\}，边集 E = \\{ \\{ \\langle x_0, y_0 \\rangle, \\langle x_1, y_1 \\rangle \\} : (|x_0 - x_1| = 3 \\land |x_0 - x_1| = 4) \\lor (|x_0 - x_1| = 4 \\land |x_0 - x_1| = 3)\\}，图 G = \\langle V, E \\rangle。易证原问题等价于证明 G 不存在 Hamilton 路径。\n\\forall \\{ \\langle x_0, y_0 \\rangle, \\langle x_1, y_1 \\rangle \\} \\in E, |x_0 - x_1| + |y_0 - y_1| = 7。于是 x_0 - x_1 + y_0 - y_1 \\equiv 1 \\pmod 2，那么 x_0 + y_0 \\not \\equiv x_1 + y_1 \\pmod 2。故 G 是二分图。\n\n引理\n偶数个顶点的二分图 G 存在完美匹配是 G 存在 Hamilton 路径的必要条件。\n证明\n设 G 的一条 Hamilton 路径为 p_1, p_2, \\dots, p_{2n}。易证 \\{\\{p_1, p_2 \\}, \\{p_3, p_4\\}, \\dots, \\{p_{2n - 1}, p_{2n}\\}\\} 是 G 的完美匹配。\n\n取 S = \\{\\langle 1, 2 \\rangle, \\langle 1, 6 \\rangle, \\langle 1, 8 \\rangle, \\langle 2, 1 \\rangle, \\langle 2, 7 \\rangle, \\langle 6, 1 \\rangle, \\langle 6, 7 \\rangle, \\langle 7, 2 \\rangle, \\langle 7, 6 \\rangle, \\langle 7, 8 \\rangle\\}，则 N_G(S) = \\{\\langle 2, 4 \\rangle, \\langle 3, 3 \\rangle, \\langle 3, 5 \\rangle, \\langle 4, 2 \\rangle, \\langle 4, 4 \\rangle, \\langle 4, 6 \\rangle, \\langle 5, 3 \\rangle, \\langle 5, 5 \\rangle, \\langle 6, 4 \\rangle\\}。|S| &gt; |N_G(S)|，由 Hall 定理有 G 不存在完美匹配。由引理有 G 不存在 Hamilton 路径。\n"},"算法/杜教筛":{"slug":"算法/杜教筛","filePath":"算法/杜教筛.md","title":"杜教筛","links":[],"tags":[],"content":"对于数论函数 f，记 S_f(n)=\\sum_{k=1}^nf(k)。\n记 R(n)=\\{\\lfloor\\frac{n}{d}\\rfloor:d\\in \\mathbb{Z}^+\\land d\\le n\\}。\n\n引理\n|R(n)|\\le2\\sqrt{n}\n证明\nd\\le\\sqrt{n}  的数不超过 \\sqrt{n} 个。对于 d&gt;\\sqrt{n}，\\lfloor\\frac{n}{d}\\rfloor&lt;\\sqrt{n}，同样不超过 \\sqrt{n} 个。\n\n称 S_f 为在 R(n) 中每个点上的值为 f 对于 n 的块筛。\n杜教筛可以对于几类特殊数论函数，O(n^{\\frac{3}{4}}) 或 O(n^{\\frac{2}{3}}) 地算出其块筛。\nDirichlet 乘法\nf,g,h 是满足 f*g=h 的数论函数，已知 f,g 的块筛，求 h 的块筛。\n\\begin{align}\nS_h(n)&amp;=\\sum_{k=1}^nh(k)\\\\\n&amp;=\\sum_{k=1}^n(f*g)(k)\\\\\n&amp;=\\sum_{k=1}^n\\sum_{d|k}f(\\frac{n}{d})g(d)\\\\\n&amp;=\\sum_{d=1}^ng(d)\\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor}f(k)\\\\\n&amp;=\\sum_{d=1}^ng(d)S_f(\\lfloor\\frac{n}{d}\\rfloor)\n\\end{align}\n数论分块计算，求单点是 O(\\sqrt{n}) 的。\n将 R(n) 中每个点单独计算。\n对于 d&gt;\\sqrt{n}，\\lfloor\\frac{n}{d}\\rfloor&lt;\\sqrt{n}。一次 O(n^{\\frac{1}{4}})，共 O(n^{\\frac{3}{4}})。\n对于 d\\le\\sqrt{n}：\n\\begin{align}\n\\sum_{d=1}^{\\lfloor\\sqrt{n}\\rfloor}\\sqrt{\\frac{n}{d}}&amp;=\\sqrt{n}\\sum_{d=1}^{\\lfloor{\\sqrt{n}}\\rfloor}d^{-\\frac{1}{2}}\\\\\n&amp;\\le\\sqrt{n}\\int_0^{\\sqrt{n}}x^{-\\frac{1}{2}}{\\rm d}x\\\\\n&amp;=2n^{\\frac{3}{4}}\n\\end{align}\n故块筛是 O(n^{\\frac{3}{4}}) 的。\n*Dirichlet 乘法\n很多时候可以快速求出 h 前 m 项的值，这里假设可以 O(m) 计算 h 前 m 项的值。\n分块。对于 \\lfloor\\frac{n}{d}\\rfloor\\le m 的点预处理，其他不变。\n\\begin{align}\nm+\\sum_{d=1}^{\\lfloor\\frac{n}{m}\\rfloor}\\sqrt{\\frac{n}{d}}&amp;=m+\\sqrt{n}\\sum_{d=1}^{\\lfloor\\frac{n}{m}\\rfloor}d^{-\\frac{1}{2}}\\\\\n&amp;\\le m+\\sqrt{n}\\int_0^\\frac{n}{m}x^{-\\frac{1}{2}}{\\rm d}x\\\\\n&amp;=m+\\frac{2n}{\\sqrt{m}}\n\\end{align}\n故取 m=n^{\\frac{2}{3}} 时复杂度降为 O(n^{\\frac{2}{3}})。\nDirichlet “除法”\nf,g,h 是满足 f*g=h 的数论函数，已知 g,h 的块筛，求 f 的块筛。\n\\begin{align}\nS_h(n)&amp;=\\sum_{d=1}^ng(d)S_f(\\lfloor\\frac{n}{d}\\rfloor)\\\\\n&amp;=g(1)S_f(n)+\\sum_{d=2}^ng(d)S_f(\\lfloor\\frac{n}{d}\\rfloor)\\\\\nS_f(n)&amp;=\\frac{S_h(n)-\\sum_{d=2}^ng(d)S_f(\\lfloor\\frac{n}{d}\\rfloor)}{g(1)}\n\\end{align}\n按 d 的递减序计算时，查询 S_f(\\lfloor\\frac{n}{d}\\rfloor) 可以做到 O(1) 。其余复杂度分析同乘法部分，是 O(n^{\\frac{3}{4}}) 的。\n*Dirichlet “除法”\n假设可以 O(m) 计算 f 前 m 项的值。取 m=n^{\\frac{2}{3}}，分块后可以做到 O(n^{\\frac{2}{3}})。"},"组合/双重计数":{"slug":"组合/双重计数","filePath":"组合/双重计数.md","title":"双重计数","links":[],"tags":[],"content":"\n定理\n\\forall n,r,s\\in\\N，有\n\\binom{n}{r}\\binom{r}{s}=\\binom{n}{s}\\binom{n-s}{r-s}\n证明\n考虑计算 |\\{\\langle A,B\\rangle:|A|=r\\land|B|=s\\land B\\subseteq A\\subseteq\\{1,2,\\dots,n\\}\\}|。\n\n先枚举 A 再枚举 B。\n先枚举 B 再枚举 A。\n\n推论\n\\forall n,m\\in\\N，有\n\\sum_{k=m}^n\\binom{n}{k}\\binom{k}{m}=\\binom{n}{m}2^{n-m}\n证明\n\\begin{align}\n\\sum_{k=m}^n\\binom{n}{k}\\binom{k}{m}&amp;=\\binom{n}{m}\\sum_{k=m}^n\\binom{n-m}{k-m}\\\\\n&amp;=\\binom{n}{m}\\sum_{k=0}^{n-m}\\binom{n-m}{k}\\\\\n&amp;=\\binom{n}{m}2^{n-m}\n\\end{align}\n定理\n记 F_n 为 Fibonacci 数列 的第 n 项。\n\\forall n\\in\\N，有\n\\sum_{i=0}^{n-1}F_i=F_{n+1}-1\n证明\n\n引理\nF_{n+1} 是用 1\\times2 和 2\\times1 的矩形铺满 2\\times n 的网格的方案数。\n证明\n易证 n=0,1 时成立。\n对于 n\\ge2，考虑开头的矩形。若是 1\\times2 的，依归纳假设得到方案数为 F_{n-1}。若是 2\\times1 的，依归纳假设得到方案数为 F_n。应用加法原理得到方案数为 F_{n-1}+F_n=F_{n+1}。\n\n考虑计算用 1\\times2 和 2\\times 1 的矩形铺满 2\\times n 的网格，存在 1\\times 2 的方案数。\n\n枚举第一个 1\\times 2 的位置。\n在所有铺满的方案中减去不存在 1\\times 2 的方案。\n\n\n定理（Cayley 公式）\nK_n 有 n^{n-2} 棵生成树。\n证明\n记 K_n 有 T_n 棵生成树。\n考虑计算序列 \\langle\\langle u_1,v_1\\rangle,\\langle u_2,v_2\\rangle,\\dots,\\langle u_{n-1},v_{n-1}\\rangle\\rangle 的个数，满足这 n-1 条有向边构成一棵顶点集为 \\{1,2,\\dots,n\\} 的有根树。\n\n\n考虑给每棵无根树指定一个根，得到有 nT_n 棵有根树。对每个边集定序都恰有 (n-1)! 种方案。应用乘法原理得到序列个数为 n!T_n。\n\n\n考虑依序加入每条有向边。加入第 i 条边前，图是由 n-i+1 棵树组成的森林。易证此时有向边 \\langle u,v\\rangle 可以加入图中当且仅当 v 是除 u 所在树之外的一棵树的根。故第 i 条边有 n(n-i) 种方案。应用乘法原理得到序列个数为 \\prod_{i=1}^{n-1}n(n-i)=n^{n-1}(n-1)!。\n\n\n综上有 n!T_n=n^{n-1}(n-1)!，即 T_n=n^{n-2}。\n定理（Vandermonde 恒等式）\n\\binom{\\sum_{i=1}^kn_i}{m}=\\sum_{\\sum_{i=1}^km_i=m}\\prod_{i=1}^k\\binom{n_i}{m_i}\n证明\n设 A_i=\\{\\langle i,1\\rangle,\\langle i,2\\rangle,\\dots,\\langle i,n_i\\rangle\\}。考虑计算在 A_1,A_2,\\dots,A_n 中选对，总共选 m 对的方案数。\n\n在 \\bigcup_{i=1}^nA_i 中选 m 对。\n枚举每个集合中选的对数。\n\n推论\n\\sum_{k=0}^{n}\\binom{n}{k}^2=\\binom{2n}{n}\n定理\n任取简单无向图 G=\\langle V,E\\rangle，若 G 不含三元环，那么\n|E|\\le\\frac{|V|^2}{4}\n证明\n设 d_v 为顶点 v 的度数。\n\n引理\n\\forall\\{u,v\\}\\in E,d_u+d_v\\le|V|\n证明\n若 d_u+d_v&gt;|V|，那么 (d_u-1)+(d_v-1)&gt;|V|-2。应用鸽巢原理有 \\exist w\\in V,\\{u,w\\}\\in E\\land\\{v,w\\}\\in E。那么 \\{\\{u,v\\},\\{v,w\\},\\{w,u\\}\\} 是 G 中的三元环。故 d_u+d_v\\le|V|。\n\n\\begin{align}\n|V||E|&amp;\\ge\\sum_{\\{u,v\\}\\in E}(d_u+d_v)\\\\\n&amp;=\\sum_{v\\in V}d_v^2\\\\\n\\end{align}\n应用 Cauchy-Schwarz 不等式得\n\\begin{align}\n\\sum_{v\\in V}d_v^2&amp;\\ge\\frac{(\\sum_{v\\in V}d_v)^2}{|V|}\\\\\n&amp;=\\frac{4|E|^2}{|V|}\n\\end{align}\n综上\n|E|\\le\\frac{|V|^2}{4}\n定理\n任取简单平面连通图 G=\\langle V,E\\rangle。设 d_v 为顶点 v 的度数。\\exist v\\in V,d_v&lt;6。\n证明\n易证 |V|&lt;3 时成立。设 |V|\\ge3。\n若 \\forall v\\in V,d_v\\ge6，有\n\\begin{align}\n2|E|&amp;=\\sum_{v\\in V}d_v\\\\\n&amp;\\ge6|V|\n\\end{align}\n即\n|E|\\ge3|V|\n|V|\\ge3 时有 |E|\\le3|V|-6。故 \\exist v\\in V,d_v&lt;6。\n推论（六色定理）\n任取简单平面图 G=\\langle V,E\\rangle。存在一种 6-染色方案，满足 \\forall\\{u,v\\}\\in E，u,v 颜色不同。\n证明\n只需证 G 连通的情况。\n易证 V=\\empty 时成立。\n对于 |V|&gt;0 的图，设 v 是一个满足 d_v&lt;6 的顶点。依归纳假设存在 G-v 的染色方案。应用鸽巢原理得到存在 v 的邻居中未出现的颜色。\n\n定理\n设顶点集 V=\\{0,1,\\dots,n-1\\}，边集 E=\\{\\{v,(v+1)\\bmod n\\}:v\\in V\\}，图 G=\\langle V,E\\rangle。\n定义 G 的两种 k-染色方案 \\langle c_0,c_1,\\dots,c_{n-1}\\rangle 和 \\langle c&#039;_0,c&#039;_1,\\dots,c&#039;_{n-1}\\rangle「本质相同」当且仅当\n\\exist i\\in\\{0,1,\\dots,n-1\\},\\forall v\\in V,c_{v}= c&#039;_{(i+v)\\bmod n}\n易证「本质相同」是等价关系。\n那么 G 的「本质不同」的 k-染色方案数为\n\\frac{1}{n}\\sum_{d|n}k^{\\frac{n}{d}}\\varphi(d)\n证明\n记 G 的「本质不同」的 k-染色方案数为 T_{n,k}。取 T_{n,k} 个「本质不同」的 k-染色方案记做 c_1,c_2,\\dots,c_{T_{n,k}}。\n考虑一张 T_{n,k}\\times n 的表格，其中第 i 行第 j 列是 c_i 的 j 次循环移位。\n考虑计算表格内序列个数。\n\n根据定义得到序列个数为 nT_{n,k}。\n考虑每种 k-染色方案的出现次数。易证相同方案只会出现在同一行。\n\n于是有\n\\begin{align}\nnT_{n,k}&amp;=\\sum_{a}\\sum_{i=1}^n[\\langle a_0,a_1,\\dots,a_{n-1}\\rangle=\\langle a_{i\\bmod n},a_{(i+1)\\bmod n},\\dots,a_{i-1}\\rangle]\\\\\n&amp;=\\sum_{i=1}^n\\sum_{a}[\\langle a_0,a_1,\\dots,a_{n-1}\\rangle=\\langle a_{i\\bmod n},a_{(i+1)\\bmod n},\\dots,a_{i-1}\\rangle]\\\\\n&amp;=\\sum_{i=1}^nk^{\\gcd(i,n)}\\\\\n&amp;=\\sum_{d|n}k^d\\sum_{i=1}^n[\\gcd(i,n)=d]\\\\\n&amp;=\\sum_{d|n}k^d\\sum_{i=1}^{\\frac{n}{d}}[\\gcd(i,\\frac{n}{d})=1]\\\\\n&amp;=\\sum_{d|n}k^d\\varphi(\\frac{n}{d})\\\\\n&amp;=\\sum_{d|n}k^\\frac{n}{d}\\varphi(d)\n\\end{align}\n即\nT_{n,k}=\\frac{1}{n}\\sum_{d|n}k^\\frac{n}{d}\\varphi(d)\n推论\nG 的「本质不同」的 k-染色方案中，要求每种颜色都出现的方案数为\n\\frac{k!}{n}\\sum_{d|n}\\varphi(d){\\frac{n}{d}\\brace k}\n证明\n记 G 的「本质不同」的 k-染色方案中，要求每种颜色都出现的方案数为 S_{n,k}。\n易证\nT_{n,k}=\\sum_{i=0}^k\\binom{k}{i}S_{n,i}\n应用二项式反演得\n\\begin{align}\nS_{n,k}&amp;=\\sum_{i=0}^k(-1)^{k-i}\\binom{k}{i}T_{n,i}\\\\\n&amp;=\\sum_{i=0}^k(-1)^{k-i}\\binom{k}{i}\\frac{1}{n}\\sum_{d|n}i^\\frac{n}{d}\\varphi(d)\\\\\n&amp;=\\frac{1}{n}\\sum_{d|n}\\varphi(d)\\sum_{i=0}^k(-1)^{k-i}\\binom{k}{i}i^\\frac{n}{d}\\\\\n&amp;=\\frac{k!}{n}\\sum_{d|n}\\varphi(d)\\sum_{i=0}^k\\frac{(-1)^{k-i}i^\\frac{n}{d}}{i!(k-i)!}\\\\\n&amp;=\\frac{k!}{n}\\sum_{d|n}\\varphi(d){\\frac{n}{d}\\brace k}\n\\end{align}\n推论\nG 的「本质不同」的 k-染色方案中，不含小于 n 的循环节的方案数为\n\\frac{1}{n}\\sum_{d|n}k^\\frac{n}{d}\\mu(d)\n证明\n记 G 的「本质不同」的 k-染色方案中，不含小于 n 的循环节的方案数为 M_{n,k}。\n易证\nT_{n,k}=\\sum_{d|n}M_{d,k}\n令 T(n)=T_{n,k},M(n)=M_{n,k},K(n)=k^n。\n那么就有\n\\begin{align}\nM*1&amp;=T\\\\\n\\operatorname{id}\\cdot(M*1)&amp;=K*\\varphi\\\\\n\\operatorname{id}\\cdot M*\\operatorname{id}&amp;=K*\\mu*\\operatorname{id}\\\\\n\\operatorname{id}\\cdot M&amp;=K*\\mu\n\\end{align}\n即\nM_{n,k}=\\frac{1}{n}\\sum_{d|n}k^\\frac{n}{d}\\mu(d)\n定理\n\\forall x\\in\\mathbb{C},n\\in\\N，有\nx^{\\overline{n}}=\\sum_{k=0}^n{n\\brack k}x^k\n证明\n设 x\\in\\N。\n考虑计算选择一个排列 p\\in S_n，并将 p 的每个轮换染色的方案数。共有 x 种颜色。\n\n考虑依次插入 1,2,\\dots,n。若 i 的后继是自己，那么有 x 种选颜色的方案。若 i 的后继不是自己，那么有 i-1 个可以选择的后继。应用加法原理得到插入 i 共有 x+i-1 种方案。应用乘法原理得到共有 \\prod_{i=1}^n(x+i-1)=x^{\\overline{n}}。\n考虑枚举轮换个数后分别对每个轮换上色。\n\n综上，x\\in\\N 时有\nx^{\\overline{n}}=\\sum_{k=0}^n{n\\brack k}x^k\n易证两边都是关于 x 的 n 次多项式，且在无穷多个点上相等，故 x\\in\\mathbb{C} 时均成立。\n推论\n\\forall x\\in\\mathbb{C},n\\in\\N，有\nx^{\\underline{n}}=\\sum_{k=0}^n(-1)^{n-k}{n\\brack k}x^k\n证明\n\\begin{align}\nx^{\\underline{n}}&amp;=(-1)^n(-x)^{\\overline{n}}\\\\\n&amp;=(-1)^n\\sum_{k=0}^n{n\\brack k}(-x)^k\\\\\n&amp;=\\sum_{k=0}^n(-1)^{n-k}{n\\brack k}x^k\n\\end{align}\n推论\n\\forall n\\in\\Z^+，长度为 n 且有偶数个轮换的排列有 \\lfloor\\frac{n!}{2}\\rfloor 个。\n证明\n\\begin{align}\n\\sum_{k=0}^{\\lfloor\\frac{n}{2}\\rfloor}{n\\brack 2k}&amp;=\\frac{\\sum_{k=0}^n{n\\brack k}1^k+\\sum_{k=0}^n{n\\brack k}(-1)^k\\\\}{2}\\\\\n&amp;=\\frac{1^{\\overline{n}}+(-1)^{\\overline n}}{2}\\\\\n&amp;=\\lfloor\\frac{n!}{2}\\rfloor\n\\end{align}\n推论\n\\forall n\\in\\Z^+，长度为 n 且有奇数个轮换的排列有 \\lceil\\frac{n!}{2}\\rceil 个。\n证明\nn!-\\lfloor\\frac{n!}{2}\\rfloor=\\lceil\\frac{n!}{2}\\rceil\n定理\n\\forall x\\in\\mathbb{C},n\\in\\N，有\nx^n=\\sum_{k=0}^n{n\\brace k}x^{\\underline{k}}\n证明\n设 x\\in\\N。\n考虑计算将 n 个有区分的球放进 x 个有区分的盒子的方案数。\n\n应用乘法原理得到方案数为 x^n\n枚举非空盒子数量。n 个有区分的球放进 k 个无区分的盒子的方案数是 n\\brace k。分配标号有 \\binom{n}{k}k!=x^{\\underline{k}} 种方案。应用乘法原理得到有 k 个非空盒子时方案数为 {n\\brace k}x^{\\underline{k}}。\n\n综上，x\\in\\N 时有\nx^n=\\sum_{k=0}^n{n\\brace k}x^{\\underline{k}}\n易证两边都是关于 x 的 n 次多项式，且在无穷多个点上相等，故 x\\in\\mathbb{C} 时均成立。\n推论\n\\forall x\\in\\mathbb{C},n\\in\\N，有\nx^n=\\sum_{k=0}^n{n\\brace k}(-1)^{n-k}x^{\\overline{k}}\n证明\n\\begin{align}\n(-x)^n&amp;=\\sum_{k=0}^n{n\\brace k}(-x)^{\\underline{k}}\\\\\n&amp;=\\sum_{k=0}^n{n\\brace k}(-1)^kx^{\\overline{k}}\\\\\nx^n&amp;=\\sum_{k=0}^n{n\\brace k}(-1)^{n-k}x^{\\overline{k}}\n\\end{align}\n定理\n任取 n\\in\\N，有\n\\frac{1}{n!}\\sum_{k=0}^n{n\\brack k}k=H_n\n证明\n均匀随机地取排列 p\\in S_n。考虑计算 p 的轮换个数的期望。\n\n\n枚举轮换个数，有 n\\brack k 个恰有 k 个轮换的排列。\n\n\n令 X 为 p 的轮换个数。若 a 是 p 的轮换，I(a)=1，否则 I(a)=0。\n易证\nX=\\sum_a\\frac{I(a)}{|a|}\n那么\n\\begin{align}\n\\mathbb{E}[X]&amp;=\\mathbb{E}\\left[\\sum_a\\frac{I(a)}{|a|}\\right]\\\\\n&amp;=\\sum_a\\frac{\\mathbb{E}[I(a)]}{|a|}\\\\\n&amp;=\\sum_a\\frac{\\Pr[I(a)=1]}{|a|}\\\\\n&amp;=\\sum_{k=1}^n\\frac{1}{k}\\sum_{|a|=k}\\Pr[I(a)=1]\\\\\n&amp;=\\sum_{k=1}^n\\frac{1}{k}\\sum_{|a|=k}\\frac{(n-k)!}{n!}\\\\\n&amp;=\\sum_{k=1}^n\\frac{1}{k}\\binom{n}{k}k!\\frac{(n-k)!}{n!}\\\\\n&amp;=\\sum_{k=1}^n\\frac{1}{k}\\\\\n&amp;=H_n\n\\end{align}\n\n"},"组合/容斥":{"slug":"组合/容斥","filePath":"组合/容斥.md","title":"容斥","links":[],"tags":[],"content":"定理（子集反演）\n设两个关于集合的函数 f, g 满足\nf(S)=\\sum_{T\\subseteq S}g(T)\n那么就有\ng(S)=\\sum_{T\\subseteq S}(-1)^{|S|-|T|}f(T)\n证明\n\\begin{align}\n\\sum_{T\\subseteq S}(-1)^{|S|-|T|}f(T)&amp;=\\sum_{T\\subseteq S}(-1)^{|S|-|T|}\\sum_{Q\\subseteq T}g(Q)\\\\\n&amp;=\\sum_{Q\\subseteq S}g(Q)\\sum_{Q\\subseteq T\\subseteq S}(-1)^{|S|-|T|}\\\\\n&amp;=\\sum_{Q\\subseteq S}g(Q)\\sum_{T\\subseteq S\\setminus Q}(-1)^{|S\\setminus Q|-|T|}\\\\\n&amp;=\\sum_{Q\\subseteq S}g(Q)\\sum_{k=0}^{|S\\setminus Q|}\\binom{|S\\setminus Q|}{k}(-1)^{|S\\setminus Q|-k}\\\\\n&amp;=\\sum_{Q\\subseteq S}g(Q)[|S\\setminus Q|=0]\\\\\n&amp;=g(S)\n\\end{align}\n推论\n设两个关于集合的函数 f(S), g(S) 满足\nf(S)=\\sum_{S\\subseteq T}g(T)\n那么就有\ng(S)=\\sum_{S\\subseteq T}(-1)^{|T|-|S|}f(T)\n定理（容斥原理）\n\\left|\\bigcap_{i=1}^nA_i\\right|=\\sum_{S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|}\\left|\\bigcap_{i\\in S}\\overline{A_i}\\right|\n证明\n令\nf(S)=\\left|\\bigcap_{i\\in S}\\overline{A_i}\\right|\ng(S)=\\left|\\bigcap_{i\\in S}\\overline{A_i}\\cap\\bigcap_{i\\notin S}A_i\\right|\n易证\nf(S)=\\sum_{S\\subseteq T}g(T)\n应用子集反演有\ng(S)=\\sum_{S\\subseteq T}(-1)^{|T|-|S|}f(T)\n于是\n\\begin{align}\n\\left|\\bigcap_{i=1}^nA_i\\right|&amp;=g(\\empty)\\\\\n&amp;=\\sum_{S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|}f(S)\\\\\n&amp;=\\sum_{S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|}\\left|\\bigcap_{i\\in S}\\overline{A_i}\\right|\n\\end{align}\n推论\n\\left|\\bigcup_{i=1}^nA_i\\right|=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\left|\\bigcap_{i\\in S}A_i\\right|\n证明\n\\begin{align}\n\\left|\\bigcup_{i=1}^nA_i\\right|&amp;=|U|-\\left|\\bigcap_{i=1}^n\\overline{A_i}\\right|\\\\\n&amp;=|U|-\\sum_{S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|}\\left|\\bigcap_{i\\in S}A_i\\right|\\\\\n&amp;=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\left|\\bigcap_{i\\in S}A_i\\right|\n\\end{align}\n定理（二项式反演）\n设两个函数 f, g 满足\nf_i=\\sum_{j=0}^i\\binom{i}{j}g_j\n那么就有\ng_i=\\sum_{j=0}^i(-1)^{i-j}\\binom{i}{j}f_j\n证明\n取 f&#039;(S)=f_{|S|},g&#039;(S)=g_{|S|}，应用子集反演易证。\n推论\n设两个函数 f, g 满足\nf_i=\\sum_{j=i}^n\\binom{j}{i}g_j\n那么就有\ng_i=\\sum_{j=i}^n(-1)^{j-i}\\binom{j}{i}f_j\n证明\n\\begin{align}\nf_i&amp;=\\sum_{j=i}^n\\binom{j}{i}g_j\\\\\n&amp;=\\sum_{j=i}^n\\frac{\\binom{n-i}{j-i}\\binom{n}{i}}{\\binom{n}{j}}g_j\\\\\n\\frac{f_i}{\\binom{n}{i}}&amp;=\\sum_{j=i}^n\\binom{n-i}{j-i}\\frac{g_j}{\\binom{n}{j}}\n\\end{align}\n取 f&#039;(S)=\\frac{f_{|S|}}{\\binom{n}{|S|}},g&#039;(S)=\\frac{g_{|S|}}{\\binom{n}{|S|}}，应用子集反演易证。\n定理（广义容斥原理）\n记\n\\alpha_i=\\sum_{S\\subseteq\\binom{\\{1,2,\\dots,n\\}}{i}}\\left|\\bigcap_{i\\in S}A_i\\right|\n\\beta_i=\\sum_{S\\subseteq\\binom{\\{1,2,\\dots,n\\}}{i}}\\left|\\bigcap_{i\\in S}A_i\\cap\\bigcap_{i\\notin S}\\overline{A_i}\\right|\n那么就有\n\\beta_i=\\sum_{j=i}^n(-1)^{j-i}\\binom{j}{i}\\alpha_j\n证明\n易证\n\\alpha_i=\\sum_{j=i}^n\\binom{j}{i}\\beta_j\n应用二项式反演有\n\\beta_i=\\sum_{j=i}^n(-1)^{j-i}\\binom{j}{i}\\alpha_j\n定理（Min-Max 容斥）\n对于任意实数序列 a = \\langle a_1,a_2,\\dots,a_n\\rangle，有\n\\min_{i=1}^na_i=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\max_{i\\in S}a_i\n证明\n不失一般性地，设 a 有序。\n\\begin{align}\n\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\max_{i\\in S}a_i&amp;=\\sum_{i=1}^na_i\\sum_{S\\subseteq\\{1,2,\\dots,i-1\\}}(-1)^{|S|}\\\\\n&amp;=\\sum_{i=1}^na_i\\sum_{j=0}^{i-1}\\binom{i-1}{j}(-1)^j\\\\\n&amp;=\\sum_{i=1}^na_i[i-1=0]\\\\\n&amp;=a_1\\\\\n&amp;=\\min_{i=1}^na_i\n\\end{align}\n推论\n对于任意实数序列 a = \\langle a_1,a_2,\\dots,a_n\\rangle，有\n\\max_{i=1}^na_i=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\min_{i\\in S}a_i\n推论\n对于任意 n 个随机变量 x=\\langle x_1,x_2,\\dots,x_n\\rangle，有\n\\mathbb{E}\\left[\\min_{i=1}^nx_i\\right]=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\mathbb{E}\\left[\\max_{i\\in S}x_i\\right]\n证明\n\\begin{align}\n\\mathbb{E}\\left[\\min_{i=1}^nx_i\\right]&amp;=\\sum_{y}\\Pr[y=x]\\min_{i=1}^ny_i\\\\\n&amp;=\\sum_{y}\\Pr[y=x]\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\max_{i\\in S}y_i\\\\\n&amp;=\\sum_{\\empty\\subset S\\subseteq \\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\sum_y\\Pr[y=x]\\max_{i\\in S}y_i\\\\\n&amp;=\\sum_{\\empty\\subset S\\subseteq \\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\mathbb{E}\\left[\\max_{i\\in S}x_i\\right]\n\\end{align}\n推论\n对于任意 n 个随机变量 x=\\langle x_1,x_2,\\dots,x_n\\rangle，有\n\\mathbb{E}\\left[\\max_{i=1}^nx_i\\right]=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\mathbb{E}\\left[\\min_{i\\in S}x_i\\right]\n推论\n对于任意正整数序列 a=\\langle a_1,a_2,\\dots,a_n\\rangle，有\n\\gcd_{i=1}^na_i=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\operatorname*{lcm}_{i\\in S}a_i\\right)^{(-1)^{|S|-1}}\n证明\n\\begin{align}\n\\gcd_{i=1}^na_i&amp;=\\gcd_{i=1}^n\\prod_{p\\in\\mathbb{P}}p^{\\nu_p(a_i)}\\\\\n&amp;=\\prod_{p\\in\\mathbb{P}}p^{\\min_{i=1}^n\\nu_p(a_i)}\\\\\n&amp;=\\prod_{p\\in\\mathbb{P}}p^{\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-1}\\max_{i\\in S}\\nu_p(a_i)}\\\\\n&amp;=\\prod_{p\\in\\mathbb{P}}\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}p^{(-1)^{|S|-1}\\max_{i\\in S}\\nu_p(a_i)}\\\\\n&amp;=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\prod_{p\\in\\mathbb{P}}p^{\\max_{i\\in S}\\nu_p(a_i)}\\right)^{(-1)^{|S|-1}}\\\\\n&amp;=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\operatorname*{lcm}_{i\\in S}\\prod_{p\\in\\mathbb{P}}p^{\\nu_p(a_i)}\\right)^{(-1)^{|S|-1}}\\\\\n&amp;=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\operatorname*{lcm}_{i\\in S}a_i\\right)^{(-1)^{|S|-1}}\n\\end{align}\n推论\n对于任意正整数序列 a=\\langle a_1,a_2,\\dots,a_n\\rangle，有\n\\operatorname*{lcm}_{i=1}^na_i=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\gcd_{i\\in S}a_i\\right)^{(-1)^{|S|-1}}\n定理（Kth-Min-Max 容斥）\n对于任意实数序列 a = \\langle a_1,a_2,\\dots,a_n\\rangle，k\\in\\Z^+\\wedge k\\le n，有\n{\\operatorname*{kthmin}_{i=1}^n}_ka_i=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-k}\\binom{|S|-1}{k-1}\\max_{i\\in S}a_i\n证明\n不失一般性地，设 a 有序。\n\\begin{align}\n\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-k}\\binom{|S|-1}{k-1}\\max_{i\\in S}a_i&amp;=\\sum_{i=1}^na_i\\sum_{S\\subseteq\\{1,2,\\dots,i-1\\}}(-1)^{|S|-k+1}\\binom{|S|}{k-1}\\\\\n&amp;=\\sum_{i=1}^na_i\\sum_{j=0}^{i-1}\\binom{i-1}{j}\\binom{j}{k-1}(-1)^{j-k+1}\\\\\n&amp;=\\sum_{i=1}^na_i\\binom{i-1}{k-1}\\sum_{j=0}^{i-1}\\binom{i-k}{j-k+1}(-1)^{j-k+1}\\\\\n&amp;=\\sum_{i=1}^na_i\\binom{i-1}{k-1}\\sum_{j=0}^{i-k}\\binom{i-k}{j}(-1)^{j}\\\\\n&amp;=\\sum_{i=1}^na_i\\binom{i-1}{k-1}[i-k=0]\\\\\n&amp;=a_k\\\\\n&amp;={\\operatorname*{kthmin}_{i=1}^n}_ka_i\n\\end{align}\n推论\n对于任意实数序列 a = \\langle a_1,a_2,\\dots,a_n\\rangle，k\\in\\Z^+\\wedge k\\le n，有\n{\\operatorname*{kthmax}_{i=1}^n}_ka_i=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-k}\\binom{|S|-1}{k-1}\\min_{i\\in S}a_i\n推论\n对于任意 n 个随机变量 x = \\langle x_1,x_2,\\dots,x_n\\rangle，k\\in\\Z^+\\wedge k\\le n，有\n\\mathbb{E}\\left[{\\operatorname*{kthmin}_{i=1}^n}_ka_i\\right]=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-k}\\binom{|S|-1}{k-1}\\mathbb{E}\\left[\\max_{i\\in S}a_i\\right]\n推论\n对于任意 n 个随机变量 x = \\langle x_1,x_2,\\dots,x_n\\rangle，k\\in\\Z^+\\wedge k\\le n，有\n\\mathbb{E}\\left[{\\operatorname*{kthmax}_{i=1}^n}_ka_i\\right]=\\sum_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}(-1)^{|S|-k}\\binom{|S|-1}{k-1}\\mathbb{E}\\left[\\min_{i\\in S}a_i\\right]\n推论\n对于任意正整数序列 a=\\langle a_1,a_2,\\dots,a_n\\rangle，k\\in\\Z^+\\wedge k\\le n，有\n{\\operatorname*{kthgcd}_{i=1}^n}_ka_i=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\operatorname*{lcm}_{i\\in S}a_i\\right)^{(-1)^{|S|-k}\\binom{|S|-1}{k-1}}\n推论\n对于任意正整数序列 a=\\langle a_1,a_2,\\dots,a_n\\rangle，k\\in\\Z^+\\wedge k\\le n，有\n{\\operatorname*{kthlcm}_{i=1}^n}_ka_i=\\prod_{\\empty\\subset S\\subseteq\\{1,2,\\dots,n\\}}\\left(\\gcd_{i\\in S}a_i\\right)^{(-1)^{|S|-k}\\binom{|S|-1}{k-1}}"},"组合/鸽巢":{"slug":"组合/鸽巢","filePath":"组合/鸽巢.md","title":"鸽巢","links":[],"tags":[],"content":"\n定理\n\\forall S\\in\\binom{\\{1,2,\\dots,2n\\}}{n+1}，\\exist x,y\\in S 满足 x&lt;y\\land x\\mid y。\n证明\n设 T_m=\\{2^km:k\\in\\N\\}。易证 \\forall x\\in S，T_1,T_3,\\dots,T_{2n-1} 这 n 个集合中恰有一个集合包含 x。应用鸽巢原理得到 \\exist x,y\\in S，满足 x&lt;y 且 x 和 y 被划分到同一个集合中。易证 x\\mid y。\n定理\n\\forall p\\in S_{mn+1}，必存在一个长度 m+1 的上升子序列或者一个长度 n+1 的下降子序列。\n证明\n设 f_i 为以 p_i 结尾的最长上升子序列长度，g_i 为以 p_i 结尾的最长下降子序列长度。\n\n引理\n\\forall i&lt;j, f_i&lt;f_j\\lor g_i&lt;g_j\n证明\n若 p_i&lt;p_j，有 f_i&lt; f_j。若 p_i&gt;p_j，有 g_i&lt;g_j。\n\n若 f_i\\le m,g_i\\le n，应用鸽巢原理得到 \\exist i&lt;j,f_i=f_j\\land g_i=g_j，由引理有存在 f_i&gt;m 或者 g_i&gt;n。\n定理\n任取两个可重集 A=\\{a_1,a_2,\\dots,a_n\\}, B=\\{b_1,b_2,\\dots,b_n\\}，其中元素都是 1 到 n 的整数，那么 \\exist A&#039;\\subseteq A,B&#039;\\subseteq B 满足 \\sum_{x\\in A&#039;}x=\\sum_{x\\in B&#039;}x。\n证明\n令 \\alpha_m=\\sum_{i=1}^ma_i, \\beta_m=\\sum_{i=1}^mb_i。不失一般性地，设 \\alpha_n\\le\\beta_n。\n令 f_i 为满足 \\alpha_i\\ge\\beta_{f_i} 的最大整数。令 \\delta_i=\\alpha_i-\\beta_{f_i}。若 \\delta_i\\ge n，那么 \\delta_i-b_{f_i+1}\\ge0，即 \\alpha_i\\ge\\beta_{f_i+1}，故 \\delta_i&lt;n。应用鸽巢原理得到 \\exist i&lt;j,\\delta_i=\\delta_j。易证取 A&#039;=\\{a_{i+1},a_{i+2},\\dots,a_j\\},B&#039;=\\{b_{f_i+1},b_{f_i+2},\\dots,b_{f_j}\\} 时 \\sum_{x\\in A&#039;}x=\\sum_{x\\in B&#039;}x。\n定理\n任取无向图 G=\\langle V,E\\rangle，每个边有一个两两不同的实数权值。那么 G 存在一条长度为 \\frac{2|E|}{|V|} 的单调上升路径。\n证明\n在每个顶点上放一个「探险家」。依边权递增序枚举每条边，交换两个顶点上的「探险家」。易证每个「探险家」对应的路径都是一条单调上升路径。「探险家」的路径长度之和为 2|E|，应用鸽巢原理得到存在一个「探险家」对应的路径长度不小于 \\frac{2|E|}{|V|}。\n定理\n任取 n 个非空区间 [l_1,r_1],[l_2,r_2],\\dots,[l_n,r_n]，满足 \\bigcup_{i=1}^n[l_i,r_i]=[0,1]。\n令\nf(I)=\\int_0^1[\\sum_{i\\in I}[x\\in[l_i,r_i]]=1]{\\rm d}x\n那么 \\exist I\\subseteq\\{1,2,\\dots,n\\},f(I)\\ge\\frac{2}{3}。\n证明\n令 I=\\{1,2,\\dots,n\\}，重复以下过程：若 i 满足 \\forall x\\in[l_i,r_i],\\exist j\\in I\\setminus\\{i\\},x\\in[l_j,r_j]，从 I 中删去 i。\n设此时 I=\\{i_1,i_2,\\dots,i_{|I|}\\}。不失一般性地，设 l_{i_j}\\le l_{i_{j+1}}。\n易证此时有 \\bigcup_{i\\in I}[l_i,r_i]=[0,1]，并且 \\forall1&lt;j&lt;|I|,r_{i_{j-1}}&lt;l_{i_{j+1}}。\n令 I_0=\\{i_j:1\\le j\\le|I|\\land j\\equiv1\\pmod2\\},I_1=I\\setminus I_0，那么就有 f(I)+f(I_0)+f(I_1)=2。应用鸽笼原理得到 \\exist I&#039;\\in\\{I,I_0,I_1\\},f(I&#039;)\\ge\\frac{2}{3}。"}}